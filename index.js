!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){!function(e){"use strict";var t=function(e){var t,n=new Float64Array(16);if(e)for(t=0;t<e.length;t++)n[t]=e[t];return n},r=function(){throw new Error("no PRNG")},i=new Uint8Array(16),o=new Uint8Array(32);o[0]=9;var a=t(),s=t([1]),c=t([56129,1]),u=t([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),l=t([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),f=t([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),p=t([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),d=t([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function h(e,t,n,r){e[t]=n>>24&255,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=255&n,e[t+4]=r>>24&255,e[t+5]=r>>16&255,e[t+6]=r>>8&255,e[t+7]=255&r}function m(e,t,n,r,i){var o,a=0;for(o=0;o<i;o++)a|=e[t+o]^n[r+o];return(1&a-1>>>8)-1}function g(e,t,n,r){return m(e,t,n,r,16)}function v(e,t,n,r){return m(e,t,n,r,32)}function y(e,t,n,r){!function(e,t,n,r){for(var i,o=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,a=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,s=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,c=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,u=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,l=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,f=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,p=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,d=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,h=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,m=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,g=255&n[16]|(255&n[17])<<8|(255&n[18])<<16|(255&n[19])<<24,v=255&n[20]|(255&n[21])<<8|(255&n[22])<<16|(255&n[23])<<24,y=255&n[24]|(255&n[25])<<8|(255&n[26])<<16|(255&n[27])<<24,b=255&n[28]|(255&n[29])<<8|(255&n[30])<<16|(255&n[31])<<24,w=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,C=o,S=a,T=s,E=c,_=u,k=l,R=f,P=p,x=d,A=h,M=m,D=g,I=v,j=y,O=b,U=w,L=0;L<20;L+=2)C^=(i=(I^=(i=(x^=(i=(_^=(i=C+I|0)<<7|i>>>25)+C|0)<<9|i>>>23)+_|0)<<13|i>>>19)+x|0)<<18|i>>>14,k^=(i=(S^=(i=(j^=(i=(A^=(i=k+S|0)<<7|i>>>25)+k|0)<<9|i>>>23)+A|0)<<13|i>>>19)+j|0)<<18|i>>>14,M^=(i=(R^=(i=(T^=(i=(O^=(i=M+R|0)<<7|i>>>25)+M|0)<<9|i>>>23)+O|0)<<13|i>>>19)+T|0)<<18|i>>>14,U^=(i=(D^=(i=(P^=(i=(E^=(i=U+D|0)<<7|i>>>25)+U|0)<<9|i>>>23)+E|0)<<13|i>>>19)+P|0)<<18|i>>>14,C^=(i=(E^=(i=(T^=(i=(S^=(i=C+E|0)<<7|i>>>25)+C|0)<<9|i>>>23)+S|0)<<13|i>>>19)+T|0)<<18|i>>>14,k^=(i=(_^=(i=(P^=(i=(R^=(i=k+_|0)<<7|i>>>25)+k|0)<<9|i>>>23)+R|0)<<13|i>>>19)+P|0)<<18|i>>>14,M^=(i=(A^=(i=(x^=(i=(D^=(i=M+A|0)<<7|i>>>25)+M|0)<<9|i>>>23)+D|0)<<13|i>>>19)+x|0)<<18|i>>>14,U^=(i=(O^=(i=(j^=(i=(I^=(i=U+O|0)<<7|i>>>25)+U|0)<<9|i>>>23)+I|0)<<13|i>>>19)+j|0)<<18|i>>>14;C=C+o|0,S=S+a|0,T=T+s|0,E=E+c|0,_=_+u|0,k=k+l|0,R=R+f|0,P=P+p|0,x=x+d|0,A=A+h|0,M=M+m|0,D=D+g|0,I=I+v|0,j=j+y|0,O=O+b|0,U=U+w|0,e[0]=C>>>0&255,e[1]=C>>>8&255,e[2]=C>>>16&255,e[3]=C>>>24&255,e[4]=S>>>0&255,e[5]=S>>>8&255,e[6]=S>>>16&255,e[7]=S>>>24&255,e[8]=T>>>0&255,e[9]=T>>>8&255,e[10]=T>>>16&255,e[11]=T>>>24&255,e[12]=E>>>0&255,e[13]=E>>>8&255,e[14]=E>>>16&255,e[15]=E>>>24&255,e[16]=_>>>0&255,e[17]=_>>>8&255,e[18]=_>>>16&255,e[19]=_>>>24&255,e[20]=k>>>0&255,e[21]=k>>>8&255,e[22]=k>>>16&255,e[23]=k>>>24&255,e[24]=R>>>0&255,e[25]=R>>>8&255,e[26]=R>>>16&255,e[27]=R>>>24&255,e[28]=P>>>0&255,e[29]=P>>>8&255,e[30]=P>>>16&255,e[31]=P>>>24&255,e[32]=x>>>0&255,e[33]=x>>>8&255,e[34]=x>>>16&255,e[35]=x>>>24&255,e[36]=A>>>0&255,e[37]=A>>>8&255,e[38]=A>>>16&255,e[39]=A>>>24&255,e[40]=M>>>0&255,e[41]=M>>>8&255,e[42]=M>>>16&255,e[43]=M>>>24&255,e[44]=D>>>0&255,e[45]=D>>>8&255,e[46]=D>>>16&255,e[47]=D>>>24&255,e[48]=I>>>0&255,e[49]=I>>>8&255,e[50]=I>>>16&255,e[51]=I>>>24&255,e[52]=j>>>0&255,e[53]=j>>>8&255,e[54]=j>>>16&255,e[55]=j>>>24&255,e[56]=O>>>0&255,e[57]=O>>>8&255,e[58]=O>>>16&255,e[59]=O>>>24&255,e[60]=U>>>0&255,e[61]=U>>>8&255,e[62]=U>>>16&255,e[63]=U>>>24&255}(e,t,n,r)}function b(e,t,n,r){!function(e,t,n,r){for(var i,o=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,a=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,s=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,c=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,u=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,l=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,f=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,p=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,d=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,h=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,m=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,g=255&n[16]|(255&n[17])<<8|(255&n[18])<<16|(255&n[19])<<24,v=255&n[20]|(255&n[21])<<8|(255&n[22])<<16|(255&n[23])<<24,y=255&n[24]|(255&n[25])<<8|(255&n[26])<<16|(255&n[27])<<24,b=255&n[28]|(255&n[29])<<8|(255&n[30])<<16|(255&n[31])<<24,w=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,C=0;C<20;C+=2)o^=(i=(v^=(i=(d^=(i=(u^=(i=o+v|0)<<7|i>>>25)+o|0)<<9|i>>>23)+u|0)<<13|i>>>19)+d|0)<<18|i>>>14,l^=(i=(a^=(i=(y^=(i=(h^=(i=l+a|0)<<7|i>>>25)+l|0)<<9|i>>>23)+h|0)<<13|i>>>19)+y|0)<<18|i>>>14,m^=(i=(f^=(i=(s^=(i=(b^=(i=m+f|0)<<7|i>>>25)+m|0)<<9|i>>>23)+b|0)<<13|i>>>19)+s|0)<<18|i>>>14,w^=(i=(g^=(i=(p^=(i=(c^=(i=w+g|0)<<7|i>>>25)+w|0)<<9|i>>>23)+c|0)<<13|i>>>19)+p|0)<<18|i>>>14,o^=(i=(c^=(i=(s^=(i=(a^=(i=o+c|0)<<7|i>>>25)+o|0)<<9|i>>>23)+a|0)<<13|i>>>19)+s|0)<<18|i>>>14,l^=(i=(u^=(i=(p^=(i=(f^=(i=l+u|0)<<7|i>>>25)+l|0)<<9|i>>>23)+f|0)<<13|i>>>19)+p|0)<<18|i>>>14,m^=(i=(h^=(i=(d^=(i=(g^=(i=m+h|0)<<7|i>>>25)+m|0)<<9|i>>>23)+g|0)<<13|i>>>19)+d|0)<<18|i>>>14,w^=(i=(b^=(i=(y^=(i=(v^=(i=w+b|0)<<7|i>>>25)+w|0)<<9|i>>>23)+v|0)<<13|i>>>19)+y|0)<<18|i>>>14;e[0]=o>>>0&255,e[1]=o>>>8&255,e[2]=o>>>16&255,e[3]=o>>>24&255,e[4]=l>>>0&255,e[5]=l>>>8&255,e[6]=l>>>16&255,e[7]=l>>>24&255,e[8]=m>>>0&255,e[9]=m>>>8&255,e[10]=m>>>16&255,e[11]=m>>>24&255,e[12]=w>>>0&255,e[13]=w>>>8&255,e[14]=w>>>16&255,e[15]=w>>>24&255,e[16]=f>>>0&255,e[17]=f>>>8&255,e[18]=f>>>16&255,e[19]=f>>>24&255,e[20]=p>>>0&255,e[21]=p>>>8&255,e[22]=p>>>16&255,e[23]=p>>>24&255,e[24]=d>>>0&255,e[25]=d>>>8&255,e[26]=d>>>16&255,e[27]=d>>>24&255,e[28]=h>>>0&255,e[29]=h>>>8&255,e[30]=h>>>16&255,e[31]=h>>>24&255}(e,t,n,r)}var w=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function C(e,t,n,r,i,o,a){var s,c,u=new Uint8Array(16),l=new Uint8Array(64);for(c=0;c<16;c++)u[c]=0;for(c=0;c<8;c++)u[c]=o[c];for(;i>=64;){for(y(l,u,a,w),c=0;c<64;c++)e[t+c]=n[r+c]^l[c];for(s=1,c=8;c<16;c++)s=s+(255&u[c])|0,u[c]=255&s,s>>>=8;i-=64,t+=64,r+=64}if(i>0)for(y(l,u,a,w),c=0;c<i;c++)e[t+c]=n[r+c]^l[c];return 0}function S(e,t,n,r,i){var o,a,s=new Uint8Array(16),c=new Uint8Array(64);for(a=0;a<16;a++)s[a]=0;for(a=0;a<8;a++)s[a]=r[a];for(;n>=64;){for(y(c,s,i,w),a=0;a<64;a++)e[t+a]=c[a];for(o=1,a=8;a<16;a++)o=o+(255&s[a])|0,s[a]=255&o,o>>>=8;n-=64,t+=64}if(n>0)for(y(c,s,i,w),a=0;a<n;a++)e[t+a]=c[a];return 0}function T(e,t,n,r,i){var o=new Uint8Array(32);b(o,r,i,w);for(var a=new Uint8Array(8),s=0;s<8;s++)a[s]=r[s+16];return S(e,t,n,a,o)}function E(e,t,n,r,i,o,a){var s=new Uint8Array(32);b(s,o,a,w);for(var c=new Uint8Array(8),u=0;u<8;u++)c[u]=o[u+16];return C(e,t,n,r,i,c,s)}var _=function(e){var t,n,r,i,o,a,s,c;this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0,t=255&e[0]|(255&e[1])<<8,this.r[0]=8191&t,n=255&e[2]|(255&e[3])<<8,this.r[1]=8191&(t>>>13|n<<3),r=255&e[4]|(255&e[5])<<8,this.r[2]=7939&(n>>>10|r<<6),i=255&e[6]|(255&e[7])<<8,this.r[3]=8191&(r>>>7|i<<9),o=255&e[8]|(255&e[9])<<8,this.r[4]=255&(i>>>4|o<<12),this.r[5]=o>>>1&8190,a=255&e[10]|(255&e[11])<<8,this.r[6]=8191&(o>>>14|a<<2),s=255&e[12]|(255&e[13])<<8,this.r[7]=8065&(a>>>11|s<<5),c=255&e[14]|(255&e[15])<<8,this.r[8]=8191&(s>>>8|c<<8),this.r[9]=c>>>5&127,this.pad[0]=255&e[16]|(255&e[17])<<8,this.pad[1]=255&e[18]|(255&e[19])<<8,this.pad[2]=255&e[20]|(255&e[21])<<8,this.pad[3]=255&e[22]|(255&e[23])<<8,this.pad[4]=255&e[24]|(255&e[25])<<8,this.pad[5]=255&e[26]|(255&e[27])<<8,this.pad[6]=255&e[28]|(255&e[29])<<8,this.pad[7]=255&e[30]|(255&e[31])<<8};function k(e,t,n,r,i,o){var a=new _(o);return a.update(n,r,i),a.finish(e,t),0}function R(e,t,n,r,i,o){var a=new Uint8Array(16);return k(a,0,n,r,i,o),g(e,t,a,0)}function P(e,t,n,r,i){var o;if(n<32)return-1;for(E(e,0,t,0,n,r,i),k(e,16,e,32,n-32,e),o=0;o<16;o++)e[o]=0;return 0}function x(e,t,n,r,i){var o,a=new Uint8Array(32);if(n<32)return-1;if(T(a,0,32,r,i),0!==R(t,16,t,32,n-32,a))return-1;for(E(e,0,t,0,n,r,i),o=0;o<32;o++)e[o]=0;return 0}function A(e,t){var n;for(n=0;n<16;n++)e[n]=0|t[n]}function M(e){var t,n,r=1;for(t=0;t<16;t++)n=e[t]+r+65535,r=Math.floor(n/65536),e[t]=n-65536*r;e[0]+=r-1+37*(r-1)}function D(e,t,n){for(var r,i=~(n-1),o=0;o<16;o++)r=i&(e[o]^t[o]),e[o]^=r,t[o]^=r}function I(e,n){var r,i,o,a=t(),s=t();for(r=0;r<16;r++)s[r]=n[r];for(M(s),M(s),M(s),i=0;i<2;i++){for(a[0]=s[0]-65517,r=1;r<15;r++)a[r]=s[r]-65535-(a[r-1]>>16&1),a[r-1]&=65535;a[15]=s[15]-32767-(a[14]>>16&1),o=a[15]>>16&1,a[14]&=65535,D(s,a,1-o)}for(r=0;r<16;r++)e[2*r]=255&s[r],e[2*r+1]=s[r]>>8}function j(e,t){var n=new Uint8Array(32),r=new Uint8Array(32);return I(n,e),I(r,t),v(n,0,r,0)}function O(e){var t=new Uint8Array(32);return I(t,e),1&t[0]}function U(e,t){var n;for(n=0;n<16;n++)e[n]=t[2*n]+(t[2*n+1]<<8);e[15]&=32767}function L(e,t,n){for(var r=0;r<16;r++)e[r]=t[r]+n[r]}function B(e,t,n){for(var r=0;r<16;r++)e[r]=t[r]-n[r]}function N(e,t,n){var r,i,o=0,a=0,s=0,c=0,u=0,l=0,f=0,p=0,d=0,h=0,m=0,g=0,v=0,y=0,b=0,w=0,C=0,S=0,T=0,E=0,_=0,k=0,R=0,P=0,x=0,A=0,M=0,D=0,I=0,j=0,O=0,U=n[0],L=n[1],B=n[2],N=n[3],$=n[4],G=n[5],F=n[6],z=n[7],Y=n[8],J=n[9],K=n[10],V=n[11],q=n[12],W=n[13],H=n[14],Z=n[15];o+=(r=t[0])*U,a+=r*L,s+=r*B,c+=r*N,u+=r*$,l+=r*G,f+=r*F,p+=r*z,d+=r*Y,h+=r*J,m+=r*K,g+=r*V,v+=r*q,y+=r*W,b+=r*H,w+=r*Z,a+=(r=t[1])*U,s+=r*L,c+=r*B,u+=r*N,l+=r*$,f+=r*G,p+=r*F,d+=r*z,h+=r*Y,m+=r*J,g+=r*K,v+=r*V,y+=r*q,b+=r*W,w+=r*H,C+=r*Z,s+=(r=t[2])*U,c+=r*L,u+=r*B,l+=r*N,f+=r*$,p+=r*G,d+=r*F,h+=r*z,m+=r*Y,g+=r*J,v+=r*K,y+=r*V,b+=r*q,w+=r*W,C+=r*H,S+=r*Z,c+=(r=t[3])*U,u+=r*L,l+=r*B,f+=r*N,p+=r*$,d+=r*G,h+=r*F,m+=r*z,g+=r*Y,v+=r*J,y+=r*K,b+=r*V,w+=r*q,C+=r*W,S+=r*H,T+=r*Z,u+=(r=t[4])*U,l+=r*L,f+=r*B,p+=r*N,d+=r*$,h+=r*G,m+=r*F,g+=r*z,v+=r*Y,y+=r*J,b+=r*K,w+=r*V,C+=r*q,S+=r*W,T+=r*H,E+=r*Z,l+=(r=t[5])*U,f+=r*L,p+=r*B,d+=r*N,h+=r*$,m+=r*G,g+=r*F,v+=r*z,y+=r*Y,b+=r*J,w+=r*K,C+=r*V,S+=r*q,T+=r*W,E+=r*H,_+=r*Z,f+=(r=t[6])*U,p+=r*L,d+=r*B,h+=r*N,m+=r*$,g+=r*G,v+=r*F,y+=r*z,b+=r*Y,w+=r*J,C+=r*K,S+=r*V,T+=r*q,E+=r*W,_+=r*H,k+=r*Z,p+=(r=t[7])*U,d+=r*L,h+=r*B,m+=r*N,g+=r*$,v+=r*G,y+=r*F,b+=r*z,w+=r*Y,C+=r*J,S+=r*K,T+=r*V,E+=r*q,_+=r*W,k+=r*H,R+=r*Z,d+=(r=t[8])*U,h+=r*L,m+=r*B,g+=r*N,v+=r*$,y+=r*G,b+=r*F,w+=r*z,C+=r*Y,S+=r*J,T+=r*K,E+=r*V,_+=r*q,k+=r*W,R+=r*H,P+=r*Z,h+=(r=t[9])*U,m+=r*L,g+=r*B,v+=r*N,y+=r*$,b+=r*G,w+=r*F,C+=r*z,S+=r*Y,T+=r*J,E+=r*K,_+=r*V,k+=r*q,R+=r*W,P+=r*H,x+=r*Z,m+=(r=t[10])*U,g+=r*L,v+=r*B,y+=r*N,b+=r*$,w+=r*G,C+=r*F,S+=r*z,T+=r*Y,E+=r*J,_+=r*K,k+=r*V,R+=r*q,P+=r*W,x+=r*H,A+=r*Z,g+=(r=t[11])*U,v+=r*L,y+=r*B,b+=r*N,w+=r*$,C+=r*G,S+=r*F,T+=r*z,E+=r*Y,_+=r*J,k+=r*K,R+=r*V,P+=r*q,x+=r*W,A+=r*H,M+=r*Z,v+=(r=t[12])*U,y+=r*L,b+=r*B,w+=r*N,C+=r*$,S+=r*G,T+=r*F,E+=r*z,_+=r*Y,k+=r*J,R+=r*K,P+=r*V,x+=r*q,A+=r*W,M+=r*H,D+=r*Z,y+=(r=t[13])*U,b+=r*L,w+=r*B,C+=r*N,S+=r*$,T+=r*G,E+=r*F,_+=r*z,k+=r*Y,R+=r*J,P+=r*K,x+=r*V,A+=r*q,M+=r*W,D+=r*H,I+=r*Z,b+=(r=t[14])*U,w+=r*L,C+=r*B,S+=r*N,T+=r*$,E+=r*G,_+=r*F,k+=r*z,R+=r*Y,P+=r*J,x+=r*K,A+=r*V,M+=r*q,D+=r*W,I+=r*H,j+=r*Z,w+=(r=t[15])*U,a+=38*(S+=r*B),s+=38*(T+=r*N),c+=38*(E+=r*$),u+=38*(_+=r*G),l+=38*(k+=r*F),f+=38*(R+=r*z),p+=38*(P+=r*Y),d+=38*(x+=r*J),h+=38*(A+=r*K),m+=38*(M+=r*V),g+=38*(D+=r*q),v+=38*(I+=r*W),y+=38*(j+=r*H),b+=38*(O+=r*Z),o=(r=(o+=38*(C+=r*L))+(i=1)+65535)-65536*(i=Math.floor(r/65536)),a=(r=a+i+65535)-65536*(i=Math.floor(r/65536)),s=(r=s+i+65535)-65536*(i=Math.floor(r/65536)),c=(r=c+i+65535)-65536*(i=Math.floor(r/65536)),u=(r=u+i+65535)-65536*(i=Math.floor(r/65536)),l=(r=l+i+65535)-65536*(i=Math.floor(r/65536)),f=(r=f+i+65535)-65536*(i=Math.floor(r/65536)),p=(r=p+i+65535)-65536*(i=Math.floor(r/65536)),d=(r=d+i+65535)-65536*(i=Math.floor(r/65536)),h=(r=h+i+65535)-65536*(i=Math.floor(r/65536)),m=(r=m+i+65535)-65536*(i=Math.floor(r/65536)),g=(r=g+i+65535)-65536*(i=Math.floor(r/65536)),v=(r=v+i+65535)-65536*(i=Math.floor(r/65536)),y=(r=y+i+65535)-65536*(i=Math.floor(r/65536)),b=(r=b+i+65535)-65536*(i=Math.floor(r/65536)),w=(r=w+i+65535)-65536*(i=Math.floor(r/65536)),o=(r=(o+=i-1+37*(i-1))+(i=1)+65535)-65536*(i=Math.floor(r/65536)),a=(r=a+i+65535)-65536*(i=Math.floor(r/65536)),s=(r=s+i+65535)-65536*(i=Math.floor(r/65536)),c=(r=c+i+65535)-65536*(i=Math.floor(r/65536)),u=(r=u+i+65535)-65536*(i=Math.floor(r/65536)),l=(r=l+i+65535)-65536*(i=Math.floor(r/65536)),f=(r=f+i+65535)-65536*(i=Math.floor(r/65536)),p=(r=p+i+65535)-65536*(i=Math.floor(r/65536)),d=(r=d+i+65535)-65536*(i=Math.floor(r/65536)),h=(r=h+i+65535)-65536*(i=Math.floor(r/65536)),m=(r=m+i+65535)-65536*(i=Math.floor(r/65536)),g=(r=g+i+65535)-65536*(i=Math.floor(r/65536)),v=(r=v+i+65535)-65536*(i=Math.floor(r/65536)),y=(r=y+i+65535)-65536*(i=Math.floor(r/65536)),b=(r=b+i+65535)-65536*(i=Math.floor(r/65536)),w=(r=w+i+65535)-65536*(i=Math.floor(r/65536)),o+=i-1+37*(i-1),e[0]=o,e[1]=a,e[2]=s,e[3]=c,e[4]=u,e[5]=l,e[6]=f,e[7]=p,e[8]=d,e[9]=h,e[10]=m,e[11]=g,e[12]=v,e[13]=y,e[14]=b,e[15]=w}function $(e,t){N(e,t,t)}function G(e,n){var r,i=t();for(r=0;r<16;r++)i[r]=n[r];for(r=253;r>=0;r--)$(i,i),2!==r&&4!==r&&N(i,i,n);for(r=0;r<16;r++)e[r]=i[r]}function F(e,n,r){var i,o,a=new Uint8Array(32),s=new Float64Array(80),u=t(),l=t(),f=t(),p=t(),d=t(),h=t();for(o=0;o<31;o++)a[o]=n[o];for(a[31]=127&n[31]|64,a[0]&=248,U(s,r),o=0;o<16;o++)l[o]=s[o],p[o]=u[o]=f[o]=0;for(u[0]=p[0]=1,o=254;o>=0;--o)D(u,l,i=a[o>>>3]>>>(7&o)&1),D(f,p,i),L(d,u,f),B(u,u,f),L(f,l,p),B(l,l,p),$(p,d),$(h,u),N(u,f,u),N(f,l,d),L(d,u,f),B(u,u,f),$(l,u),B(f,p,h),N(u,f,c),L(u,u,p),N(f,f,u),N(u,p,h),N(p,l,s),$(l,d),D(u,l,i),D(f,p,i);for(o=0;o<16;o++)s[o+16]=u[o],s[o+32]=f[o],s[o+48]=l[o],s[o+64]=p[o];var m=s.subarray(32),g=s.subarray(16);return G(m,m),N(g,g,m),I(e,g),0}function z(e,t){return F(e,t,o)}function Y(e,t){return r(t,32),z(e,t)}function J(e,t,n){var r=new Uint8Array(32);return F(r,n,t),b(e,i,r,w)}_.prototype.blocks=function(e,t,n){for(var r,i,o,a,s,c,u,l,f,p,d,h,m,g,v,y,b,w,C,S=this.fin?0:2048,T=this.h[0],E=this.h[1],_=this.h[2],k=this.h[3],R=this.h[4],P=this.h[5],x=this.h[6],A=this.h[7],M=this.h[8],D=this.h[9],I=this.r[0],j=this.r[1],O=this.r[2],U=this.r[3],L=this.r[4],B=this.r[5],N=this.r[6],$=this.r[7],G=this.r[8],F=this.r[9];n>=16;)p=f=0,p+=(T+=8191&(r=255&e[t+0]|(255&e[t+1])<<8))*I,p+=(E+=8191&(r>>>13|(i=255&e[t+2]|(255&e[t+3])<<8)<<3))*(5*F),p+=(_+=8191&(i>>>10|(o=255&e[t+4]|(255&e[t+5])<<8)<<6))*(5*G),p+=(k+=8191&(o>>>7|(a=255&e[t+6]|(255&e[t+7])<<8)<<9))*(5*$),f=(p+=(R+=8191&(a>>>4|(s=255&e[t+8]|(255&e[t+9])<<8)<<12))*(5*N))>>>13,p&=8191,p+=(P+=s>>>1&8191)*(5*B),p+=(x+=8191&(s>>>14|(c=255&e[t+10]|(255&e[t+11])<<8)<<2))*(5*L),p+=(A+=8191&(c>>>11|(u=255&e[t+12]|(255&e[t+13])<<8)<<5))*(5*U),p+=(M+=8191&(u>>>8|(l=255&e[t+14]|(255&e[t+15])<<8)<<8))*(5*O),d=f+=(p+=(D+=l>>>5|S)*(5*j))>>>13,d+=T*j,d+=E*I,d+=_*(5*F),d+=k*(5*G),f=(d+=R*(5*$))>>>13,d&=8191,d+=P*(5*N),d+=x*(5*B),d+=A*(5*L),d+=M*(5*U),f+=(d+=D*(5*O))>>>13,d&=8191,h=f,h+=T*O,h+=E*j,h+=_*I,h+=k*(5*F),f=(h+=R*(5*G))>>>13,h&=8191,h+=P*(5*$),h+=x*(5*N),h+=A*(5*B),h+=M*(5*L),m=f+=(h+=D*(5*U))>>>13,m+=T*U,m+=E*O,m+=_*j,m+=k*I,f=(m+=R*(5*F))>>>13,m&=8191,m+=P*(5*G),m+=x*(5*$),m+=A*(5*N),m+=M*(5*B),g=f+=(m+=D*(5*L))>>>13,g+=T*L,g+=E*U,g+=_*O,g+=k*j,f=(g+=R*I)>>>13,g&=8191,g+=P*(5*F),g+=x*(5*G),g+=A*(5*$),g+=M*(5*N),v=f+=(g+=D*(5*B))>>>13,v+=T*B,v+=E*L,v+=_*U,v+=k*O,f=(v+=R*j)>>>13,v&=8191,v+=P*I,v+=x*(5*F),v+=A*(5*G),v+=M*(5*$),y=f+=(v+=D*(5*N))>>>13,y+=T*N,y+=E*B,y+=_*L,y+=k*U,f=(y+=R*O)>>>13,y&=8191,y+=P*j,y+=x*I,y+=A*(5*F),y+=M*(5*G),b=f+=(y+=D*(5*$))>>>13,b+=T*$,b+=E*N,b+=_*B,b+=k*L,f=(b+=R*U)>>>13,b&=8191,b+=P*O,b+=x*j,b+=A*I,b+=M*(5*F),w=f+=(b+=D*(5*G))>>>13,w+=T*G,w+=E*$,w+=_*N,w+=k*B,f=(w+=R*L)>>>13,w&=8191,w+=P*U,w+=x*O,w+=A*j,w+=M*I,C=f+=(w+=D*(5*F))>>>13,C+=T*F,C+=E*G,C+=_*$,C+=k*N,f=(C+=R*B)>>>13,C&=8191,C+=P*L,C+=x*U,C+=A*O,C+=M*j,T=p=8191&(f=(f=((f+=(C+=D*I)>>>13)<<2)+f|0)+(p&=8191)|0),E=d+=f>>>=13,_=h&=8191,k=m&=8191,R=g&=8191,P=v&=8191,x=y&=8191,A=b&=8191,M=w&=8191,D=C&=8191,t+=16,n-=16;this.h[0]=T,this.h[1]=E,this.h[2]=_,this.h[3]=k,this.h[4]=R,this.h[5]=P,this.h[6]=x,this.h[7]=A,this.h[8]=M,this.h[9]=D},_.prototype.finish=function(e,t){var n,r,i,o,a=new Uint16Array(10);if(this.leftover){for(o=this.leftover,this.buffer[o++]=1;o<16;o++)this.buffer[o]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(n=this.h[1]>>>13,this.h[1]&=8191,o=2;o<10;o++)this.h[o]+=n,n=this.h[o]>>>13,this.h[o]&=8191;for(this.h[0]+=5*n,n=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=n,n=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=n,a[0]=this.h[0]+5,n=a[0]>>>13,a[0]&=8191,o=1;o<10;o++)a[o]=this.h[o]+n,n=a[o]>>>13,a[o]&=8191;for(a[9]-=8192,r=(1^n)-1,o=0;o<10;o++)a[o]&=r;for(r=~r,o=0;o<10;o++)this.h[o]=this.h[o]&r|a[o];for(this.h[0]=65535&(this.h[0]|this.h[1]<<13),this.h[1]=65535&(this.h[1]>>>3|this.h[2]<<10),this.h[2]=65535&(this.h[2]>>>6|this.h[3]<<7),this.h[3]=65535&(this.h[3]>>>9|this.h[4]<<4),this.h[4]=65535&(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14),this.h[5]=65535&(this.h[6]>>>2|this.h[7]<<11),this.h[6]=65535&(this.h[7]>>>5|this.h[8]<<8),this.h[7]=65535&(this.h[8]>>>8|this.h[9]<<5),i=this.h[0]+this.pad[0],this.h[0]=65535&i,o=1;o<8;o++)i=(this.h[o]+this.pad[o]|0)+(i>>>16)|0,this.h[o]=65535&i;e[t+0]=this.h[0]>>>0&255,e[t+1]=this.h[0]>>>8&255,e[t+2]=this.h[1]>>>0&255,e[t+3]=this.h[1]>>>8&255,e[t+4]=this.h[2]>>>0&255,e[t+5]=this.h[2]>>>8&255,e[t+6]=this.h[3]>>>0&255,e[t+7]=this.h[3]>>>8&255,e[t+8]=this.h[4]>>>0&255,e[t+9]=this.h[4]>>>8&255,e[t+10]=this.h[5]>>>0&255,e[t+11]=this.h[5]>>>8&255,e[t+12]=this.h[6]>>>0&255,e[t+13]=this.h[6]>>>8&255,e[t+14]=this.h[7]>>>0&255,e[t+15]=this.h[7]>>>8&255},_.prototype.update=function(e,t,n){var r,i;if(this.leftover){for((i=16-this.leftover)>n&&(i=n),r=0;r<i;r++)this.buffer[this.leftover+r]=e[t+r];if(n-=i,t+=i,this.leftover+=i,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(n>=16&&(i=n-n%16,this.blocks(e,t,i),t+=i,n-=i),n){for(r=0;r<n;r++)this.buffer[this.leftover+r]=e[t+r];this.leftover+=n}};var K=P,V=x;var q=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function W(e,t,n,r){for(var i,o,a,s,c,u,l,f,p,d,h,m,g,v,y,b,w,C,S,T,E,_,k,R,P,x,A=new Int32Array(16),M=new Int32Array(16),D=e[0],I=e[1],j=e[2],O=e[3],U=e[4],L=e[5],B=e[6],N=e[7],$=t[0],G=t[1],F=t[2],z=t[3],Y=t[4],J=t[5],K=t[6],V=t[7],W=0;r>=128;){for(S=0;S<16;S++)T=8*S+W,A[S]=n[T+0]<<24|n[T+1]<<16|n[T+2]<<8|n[T+3],M[S]=n[T+4]<<24|n[T+5]<<16|n[T+6]<<8|n[T+7];for(S=0;S<80;S++)if(i=D,o=I,a=j,s=O,c=U,u=L,l=B,N,p=$,d=G,h=F,m=z,g=Y,v=J,y=K,V,k=65535&(_=V),R=_>>>16,P=65535&(E=N),x=E>>>16,k+=65535&(_=(Y>>>14|U<<18)^(Y>>>18|U<<14)^(U>>>9|Y<<23)),R+=_>>>16,P+=65535&(E=(U>>>14|Y<<18)^(U>>>18|Y<<14)^(Y>>>9|U<<23)),x+=E>>>16,k+=65535&(_=Y&J^~Y&K),R+=_>>>16,P+=65535&(E=U&L^~U&B),x+=E>>>16,E=q[2*S],k+=65535&(_=q[2*S+1]),R+=_>>>16,P+=65535&E,x+=E>>>16,E=A[S%16],R+=(_=M[S%16])>>>16,P+=65535&E,x+=E>>>16,P+=(R+=(k+=65535&_)>>>16)>>>16,k=65535&(_=C=65535&k|R<<16),R=_>>>16,P=65535&(E=w=65535&P|(x+=P>>>16)<<16),x=E>>>16,k+=65535&(_=($>>>28|D<<4)^(D>>>2|$<<30)^(D>>>7|$<<25)),R+=_>>>16,P+=65535&(E=(D>>>28|$<<4)^($>>>2|D<<30)^($>>>7|D<<25)),x+=E>>>16,R+=(_=$&G^$&F^G&F)>>>16,P+=65535&(E=D&I^D&j^I&j),x+=E>>>16,f=65535&(P+=(R+=(k+=65535&_)>>>16)>>>16)|(x+=P>>>16)<<16,b=65535&k|R<<16,k=65535&(_=m),R=_>>>16,P=65535&(E=s),x=E>>>16,R+=(_=C)>>>16,P+=65535&(E=w),x+=E>>>16,I=i,j=o,O=a,U=s=65535&(P+=(R+=(k+=65535&_)>>>16)>>>16)|(x+=P>>>16)<<16,L=c,B=u,N=l,D=f,G=p,F=d,z=h,Y=m=65535&k|R<<16,J=g,K=v,V=y,$=b,S%16==15)for(T=0;T<16;T++)E=A[T],k=65535&(_=M[T]),R=_>>>16,P=65535&E,x=E>>>16,E=A[(T+9)%16],k+=65535&(_=M[(T+9)%16]),R+=_>>>16,P+=65535&E,x+=E>>>16,w=A[(T+1)%16],k+=65535&(_=((C=M[(T+1)%16])>>>1|w<<31)^(C>>>8|w<<24)^(C>>>7|w<<25)),R+=_>>>16,P+=65535&(E=(w>>>1|C<<31)^(w>>>8|C<<24)^w>>>7),x+=E>>>16,w=A[(T+14)%16],R+=(_=((C=M[(T+14)%16])>>>19|w<<13)^(w>>>29|C<<3)^(C>>>6|w<<26))>>>16,P+=65535&(E=(w>>>19|C<<13)^(C>>>29|w<<3)^w>>>6),x+=E>>>16,x+=(P+=(R+=(k+=65535&_)>>>16)>>>16)>>>16,A[T]=65535&P|x<<16,M[T]=65535&k|R<<16;k=65535&(_=$),R=_>>>16,P=65535&(E=D),x=E>>>16,E=e[0],R+=(_=t[0])>>>16,P+=65535&E,x+=E>>>16,x+=(P+=(R+=(k+=65535&_)>>>16)>>>16)>>>16,e[0]=D=65535&P|x<<16,t[0]=$=65535&k|R<<16,k=65535&(_=G),R=_>>>16,P=65535&(E=I),x=E>>>16,E=e[1],R+=(_=t[1])>>>16,P+=65535&E,x+=E>>>16,x+=(P+=(R+=(k+=65535&_)>>>16)>>>16)>>>16,e[1]=I=65535&P|x<<16,t[1]=G=65535&k|R<<16,k=65535&(_=F),R=_>>>16,P=65535&(E=j),x=E>>>16,E=e[2],R+=(_=t[2])>>>16,P+=65535&E,x+=E>>>16,x+=(P+=(R+=(k+=65535&_)>>>16)>>>16)>>>16,e[2]=j=65535&P|x<<16,t[2]=F=65535&k|R<<16,k=65535&(_=z),R=_>>>16,P=65535&(E=O),x=E>>>16,E=e[3],R+=(_=t[3])>>>16,P+=65535&E,x+=E>>>16,x+=(P+=(R+=(k+=65535&_)>>>16)>>>16)>>>16,e[3]=O=65535&P|x<<16,t[3]=z=65535&k|R<<16,k=65535&(_=Y),R=_>>>16,P=65535&(E=U),x=E>>>16,E=e[4],R+=(_=t[4])>>>16,P+=65535&E,x+=E>>>16,x+=(P+=(R+=(k+=65535&_)>>>16)>>>16)>>>16,e[4]=U=65535&P|x<<16,t[4]=Y=65535&k|R<<16,k=65535&(_=J),R=_>>>16,P=65535&(E=L),x=E>>>16,E=e[5],R+=(_=t[5])>>>16,P+=65535&E,x+=E>>>16,x+=(P+=(R+=(k+=65535&_)>>>16)>>>16)>>>16,e[5]=L=65535&P|x<<16,t[5]=J=65535&k|R<<16,k=65535&(_=K),R=_>>>16,P=65535&(E=B),x=E>>>16,E=e[6],R+=(_=t[6])>>>16,P+=65535&E,x+=E>>>16,x+=(P+=(R+=(k+=65535&_)>>>16)>>>16)>>>16,e[6]=B=65535&P|x<<16,t[6]=K=65535&k|R<<16,k=65535&(_=V),R=_>>>16,P=65535&(E=N),x=E>>>16,E=e[7],R+=(_=t[7])>>>16,P+=65535&E,x+=E>>>16,x+=(P+=(R+=(k+=65535&_)>>>16)>>>16)>>>16,e[7]=N=65535&P|x<<16,t[7]=V=65535&k|R<<16,W+=128,r-=128}return r}function H(e,t,n){var r,i=new Int32Array(8),o=new Int32Array(8),a=new Uint8Array(256),s=n;for(i[0]=1779033703,i[1]=3144134277,i[2]=1013904242,i[3]=2773480762,i[4]=1359893119,i[5]=2600822924,i[6]=528734635,i[7]=1541459225,o[0]=4089235720,o[1]=2227873595,o[2]=4271175723,o[3]=1595750129,o[4]=2917565137,o[5]=725511199,o[6]=4215389547,o[7]=327033209,W(i,o,t,n),n%=128,r=0;r<n;r++)a[r]=t[s-n+r];for(a[n]=128,a[(n=256-128*(n<112?1:0))-9]=0,h(a,n-8,s/536870912|0,s<<3),W(i,o,a,n),r=0;r<8;r++)h(e,8*r,i[r],o[r]);return 0}function Z(e,n){var r=t(),i=t(),o=t(),a=t(),s=t(),c=t(),u=t(),f=t(),p=t();B(r,e[1],e[0]),B(p,n[1],n[0]),N(r,r,p),L(i,e[0],e[1]),L(p,n[0],n[1]),N(i,i,p),N(o,e[3],n[3]),N(o,o,l),N(a,e[2],n[2]),L(a,a,a),B(s,i,r),B(c,a,o),L(u,a,o),L(f,i,r),N(e[0],s,c),N(e[1],f,u),N(e[2],u,c),N(e[3],s,f)}function X(e,t,n){var r;for(r=0;r<4;r++)D(e[r],t[r],n)}function Q(e,n){var r=t(),i=t(),o=t();G(o,n[2]),N(r,n[0],o),N(i,n[1],o),I(e,i),e[31]^=O(r)<<7}function ee(e,t,n){var r,i;for(A(e[0],a),A(e[1],s),A(e[2],s),A(e[3],a),i=255;i>=0;--i)X(e,t,r=n[i/8|0]>>(7&i)&1),Z(t,e),Z(e,e),X(e,t,r)}function te(e,n){var r=[t(),t(),t(),t()];A(r[0],f),A(r[1],p),A(r[2],s),N(r[3],f,p),ee(e,r,n)}function ne(e,n,i){var o,a=new Uint8Array(64),s=[t(),t(),t(),t()];for(i||r(n,32),H(a,n,32),a[0]&=248,a[31]&=127,a[31]|=64,te(s,a),Q(e,s),o=0;o<32;o++)n[o+32]=e[o];return 0}var re=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function ie(e,t){var n,r,i,o;for(r=63;r>=32;--r){for(n=0,i=r-32,o=r-12;i<o;++i)t[i]+=n-16*t[r]*re[i-(r-32)],n=t[i]+128>>8,t[i]-=256*n;t[i]+=n,t[r]=0}for(n=0,i=0;i<32;i++)t[i]+=n-(t[31]>>4)*re[i],n=t[i]>>8,t[i]&=255;for(i=0;i<32;i++)t[i]-=n*re[i];for(r=0;r<32;r++)t[r+1]+=t[r]>>8,e[r]=255&t[r]}function oe(e){var t,n=new Float64Array(64);for(t=0;t<64;t++)n[t]=e[t];for(t=0;t<64;t++)e[t]=0;ie(e,n)}function ae(e,n,r,i){var o,a,s=new Uint8Array(64),c=new Uint8Array(64),u=new Uint8Array(64),l=new Float64Array(64),f=[t(),t(),t(),t()];H(s,i,32),s[0]&=248,s[31]&=127,s[31]|=64;var p=r+64;for(o=0;o<r;o++)e[64+o]=n[o];for(o=0;o<32;o++)e[32+o]=s[32+o];for(H(u,e.subarray(32),r+32),oe(u),te(f,u),Q(e,f),o=32;o<64;o++)e[o]=i[o];for(H(c,e,r+64),oe(c),o=0;o<64;o++)l[o]=0;for(o=0;o<32;o++)l[o]=u[o];for(o=0;o<32;o++)for(a=0;a<32;a++)l[o+a]+=c[o]*s[a];return ie(e.subarray(32),l),p}function se(e,n){var r=t(),i=t(),o=t(),c=t(),l=t(),f=t(),p=t();return A(e[2],s),U(e[1],n),$(o,e[1]),N(c,o,u),B(o,o,e[2]),L(c,e[2],c),$(l,c),$(f,l),N(p,f,l),N(r,p,o),N(r,r,c),function(e,n){var r,i=t();for(r=0;r<16;r++)i[r]=n[r];for(r=250;r>=0;r--)$(i,i),1!==r&&N(i,i,n);for(r=0;r<16;r++)e[r]=i[r]}(r,r),N(r,r,o),N(r,r,c),N(r,r,c),N(e[0],r,c),$(i,e[0]),N(i,i,c),j(i,o)&&N(e[0],e[0],d),$(i,e[0]),N(i,i,c),j(i,o)?-1:(O(e[0])===n[31]>>7&&B(e[0],a,e[0]),N(e[3],e[0],e[1]),0)}function ce(e,n,r,i){var o,a=new Uint8Array(32),s=new Uint8Array(64),c=[t(),t(),t(),t()],u=[t(),t(),t(),t()];if(-1,r<64)return-1;if(se(u,i))return-1;for(o=0;o<r;o++)e[o]=n[o];for(o=0;o<32;o++)e[o+32]=i[o];if(H(s,e,r),oe(s),ee(c,u,s),te(u,n.subarray(32)),Z(c,u),Q(a,c),r-=64,v(n,0,a,0)){for(o=0;o<r;o++)e[o]=0;return-1}for(o=0;o<r;o++)e[o]=n[o+64];return r}var ue=32,le=24,fe=32,pe=32,de=le;function he(e,t){if(e.length!==ue)throw new Error("bad key size");if(t.length!==le)throw new Error("bad nonce size")}function me(){for(var e=0;e<arguments.length;e++)if(!(arguments[e]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function ge(e){for(var t=0;t<e.length;t++)e[t]=0}e.lowlevel={crypto_core_hsalsa20:b,crypto_stream_xor:E,crypto_stream:T,crypto_stream_salsa20_xor:C,crypto_stream_salsa20:S,crypto_onetimeauth:k,crypto_onetimeauth_verify:R,crypto_verify_16:g,crypto_verify_32:v,crypto_secretbox:P,crypto_secretbox_open:x,crypto_scalarmult:F,crypto_scalarmult_base:z,crypto_box_beforenm:J,crypto_box_afternm:K,crypto_box:function(e,t,n,r,i,o){var a=new Uint8Array(32);return J(a,i,o),K(e,t,n,r,a)},crypto_box_open:function(e,t,n,r,i,o){var a=new Uint8Array(32);return J(a,i,o),V(e,t,n,r,a)},crypto_box_keypair:Y,crypto_hash:H,crypto_sign:ae,crypto_sign_keypair:ne,crypto_sign_open:ce,crypto_secretbox_KEYBYTES:ue,crypto_secretbox_NONCEBYTES:le,crypto_secretbox_ZEROBYTES:32,crypto_secretbox_BOXZEROBYTES:16,crypto_scalarmult_BYTES:32,crypto_scalarmult_SCALARBYTES:32,crypto_box_PUBLICKEYBYTES:fe,crypto_box_SECRETKEYBYTES:pe,crypto_box_BEFORENMBYTES:32,crypto_box_NONCEBYTES:de,crypto_box_ZEROBYTES:32,crypto_box_BOXZEROBYTES:16,crypto_sign_BYTES:64,crypto_sign_PUBLICKEYBYTES:32,crypto_sign_SECRETKEYBYTES:64,crypto_sign_SEEDBYTES:32,crypto_hash_BYTES:64},e.randomBytes=function(e){var t=new Uint8Array(e);return r(t,e),t},e.secretbox=function(e,t,n){me(e,t,n),he(n,t);for(var r=new Uint8Array(32+e.length),i=new Uint8Array(r.length),o=0;o<e.length;o++)r[o+32]=e[o];return P(i,r,r.length,t,n),i.subarray(16)},e.secretbox.open=function(e,t,n){me(e,t,n),he(n,t);for(var r=new Uint8Array(16+e.length),i=new Uint8Array(r.length),o=0;o<e.length;o++)r[o+16]=e[o];return r.length<32?null:0!==x(i,r,r.length,t,n)?null:i.subarray(32)},e.secretbox.keyLength=ue,e.secretbox.nonceLength=le,e.secretbox.overheadLength=16,e.scalarMult=function(e,t){if(me(e,t),32!==e.length)throw new Error("bad n size");if(32!==t.length)throw new Error("bad p size");var n=new Uint8Array(32);return F(n,e,t),n},e.scalarMult.base=function(e){if(me(e),32!==e.length)throw new Error("bad n size");var t=new Uint8Array(32);return z(t,e),t},e.scalarMult.scalarLength=32,e.scalarMult.groupElementLength=32,e.box=function(t,n,r,i){var o=e.box.before(r,i);return e.secretbox(t,n,o)},e.box.before=function(e,t){me(e,t),function(e,t){if(e.length!==fe)throw new Error("bad public key size");if(t.length!==pe)throw new Error("bad secret key size")}(e,t);var n=new Uint8Array(32);return J(n,e,t),n},e.box.after=e.secretbox,e.box.open=function(t,n,r,i){var o=e.box.before(r,i);return e.secretbox.open(t,n,o)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var e=new Uint8Array(fe),t=new Uint8Array(pe);return Y(e,t),{publicKey:e,secretKey:t}},e.box.keyPair.fromSecretKey=function(e){if(me(e),e.length!==pe)throw new Error("bad secret key size");var t=new Uint8Array(fe);return z(t,e),{publicKey:t,secretKey:new Uint8Array(e)}},e.box.publicKeyLength=fe,e.box.secretKeyLength=pe,e.box.sharedKeyLength=32,e.box.nonceLength=de,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(e,t){if(me(e,t),64!==t.length)throw new Error("bad secret key size");var n=new Uint8Array(64+e.length);return ae(n,e,e.length,t),n},e.sign.open=function(e,t){if(me(e,t),32!==t.length)throw new Error("bad public key size");var n=new Uint8Array(e.length),r=ce(n,e,e.length,t);if(r<0)return null;for(var i=new Uint8Array(r),o=0;o<i.length;o++)i[o]=n[o];return i},e.sign.detached=function(t,n){for(var r=e.sign(t,n),i=new Uint8Array(64),o=0;o<i.length;o++)i[o]=r[o];return i},e.sign.detached.verify=function(e,t,n){if(me(e,t,n),64!==t.length)throw new Error("bad signature size");if(32!==n.length)throw new Error("bad public key size");var r,i=new Uint8Array(64+e.length),o=new Uint8Array(64+e.length);for(r=0;r<64;r++)i[r]=t[r];for(r=0;r<e.length;r++)i[r+64]=e[r];return ce(o,i,i.length,n)>=0},e.sign.keyPair=function(){var e=new Uint8Array(32),t=new Uint8Array(64);return ne(e,t),{publicKey:e,secretKey:t}},e.sign.keyPair.fromSecretKey=function(e){if(me(e),64!==e.length)throw new Error("bad secret key size");for(var t=new Uint8Array(32),n=0;n<t.length;n++)t[n]=e[32+n];return{publicKey:t,secretKey:new Uint8Array(e)}},e.sign.keyPair.fromSeed=function(e){if(me(e),32!==e.length)throw new Error("bad seed size");for(var t=new Uint8Array(32),n=new Uint8Array(64),r=0;r<32;r++)n[r]=e[r];return ne(t,n,!0),{publicKey:t,secretKey:n}},e.sign.publicKeyLength=32,e.sign.secretKeyLength=64,e.sign.seedLength=32,e.sign.signatureLength=64,e.hash=function(e){me(e);var t=new Uint8Array(64);return H(t,e,e.length),t},e.hash.hashLength=64,e.verify=function(e,t){return me(e,t),0!==e.length&&0!==t.length&&(e.length===t.length&&0===m(e,0,t,0,e.length))},e.setPRNG=function(e){r=e},function(){var t="undefined"!=typeof self?self.crypto||self.msCrypto:null;if(t&&t.getRandomValues){e.setPRNG(function(e,n){var r,i=new Uint8Array(n);for(r=0;r<n;r+=65536)t.getRandomValues(i.subarray(r,r+Math.min(n-r,65536)));for(r=0;r<n;r++)e[r]=i[r];ge(i)})}else(t=n(7))&&t.randomBytes&&e.setPRNG(function(e,n){var r,i=t.randomBytes(n);for(r=0;r<n;r++)e[r]=i[r];ge(i)})}()}(e.exports?e.exports:self.nacl=self.nacl||{})},function(e,t,n){(function(t){!function(t,n){"use strict";e.exports?e.exports=n():t.nacl?t.nacl.util=n():(t.nacl={},t.nacl.util=n())}(this,function(){"use strict";var e={};function n(e){if(!/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(e))throw new TypeError("invalid encoding")}return e.decodeUTF8=function(e){if("string"!=typeof e)throw new TypeError("expected string");var t,n=unescape(encodeURIComponent(e)),r=new Uint8Array(n.length);for(t=0;t<n.length;t++)r[t]=n.charCodeAt(t);return r},e.encodeUTF8=function(e){var t,n=[];for(t=0;t<e.length;t++)n.push(String.fromCharCode(e[t]));return decodeURIComponent(escape(n.join("")))},"undefined"==typeof atob?void 0!==t.from?(e.encodeBase64=function(e){return t.from(e).toString("base64")},e.decodeBase64=function(e){return n(e),new Uint8Array(Array.prototype.slice.call(t.from(e,"base64"),0))}):(e.encodeBase64=function(e){return new t(e).toString("base64")},e.decodeBase64=function(e){return n(e),new Uint8Array(Array.prototype.slice.call(new t(e,"base64"),0))}):(e.encodeBase64=function(e){var t,n=[],r=e.length;for(t=0;t<r;t++)n.push(String.fromCharCode(e[t]));return btoa(n.join(""))},e.decodeBase64=function(e){n(e);var t,r=atob(e),i=new Uint8Array(r.length);for(t=0;t<r.length;t++)i[t]=r.charCodeAt(t);return i}),e})}).call(this,n(8).Buffer)},function(e){e.exports={adjectives:["adorable","adventurous","alluring","amazing","ambitious","amusing","astonishing","attractive","awesome","bashful","bawdy","beautiful","bewildered","bizarre","bouncy","brainy","brave","brawny","burly","capricious","careful","caring","cautious","charming","cheerful","chivalrous","classy","clever","clumsy","colossal","cool","coordinated","courageous","cuddly","curious","cute","daffy","dapper","dashing","dazzling","delicate","delightful","determined","eager","embarrassed","enchanted","energetic","enormous","entertaining","enthralling","enthusiastic","evanescent","excited","exotic","exuberant","exultant","fabulous","fancy","festive","finicky","flashy","flippant","fluffy","fluttering","funny","furry","fuzzy","gaudy","gentle","giddy","glamorous","gleaming","goofy","gorgeous","graceful","grandiose","groovy","handsome","happy","hilarious","honorable","hulking","humorous","industrious","incredible","intelligent","jazzy","jolly","joyous","kind","macho","magnificent","majestic","marvelous","mighty","mysterious","naughty","nimble","nutty","oafish","obnoxious","outrageous","pretty","psychedelic","psychotic","puzzled","quirky","quizzical","rambunctious","remarkable","sassy","shaggy","smelly","sneaky","spiffy","swanky","sweet","swift","talented","thundering","unkempt","upbeat","uppity","wacky","waggish","whimsical","wiggly","zany"],nouns:["aardvarks","alligators","alpacas","anteaters","antelopes","armadillos","baboons","badgers","bears","beavers","boars","buffalos","bulls","bunnies","camels","cats","chameleons","cheetahs","centaurs","chickens","chimpanzees","chinchillas","chipmunks","cougars","cows","coyotes","cranes","crickets","crocodiles","deers","dinasaurs","dingos","dogs","donkeys","dragons","elephants","elves","ferrets","flamingos","foxes","frogs","gazelles","giraffes","gnomes","gnus","goats","gophers","gorillas","hamsters","hedgehogs","hippopotamus","hobbits","hogs","horses","hyenas","ibexes","iguanas","impalas","jackals","jackalopes","jaguars","kangaroos","kittens","koalas","lambs","lemmings","leopards","lions","ligers","lizards","llamas","lynxes","meerkat","moles","mongooses","monkeys","moose","mules","newts","okapis","orangutans","ostriches","otters","oxes","pandas","panthers","peacocks","pegasuses","phoenixes","pigeons","pigs","platypuses","ponies","porcupines","porpoises","pumas","pythons","rabbits","raccoons","rams","reindeers","rhinoceroses","salamanders","seals","sheep","skunks","sloths","slugs","snails","snakes","sphinxes","sprites","squirrels","takins","tigers","toads","trolls","turtles","unicorns","walruses","warthogs","weasels","wolves","wolverines","wombats","woodchucks","yaks","zebras"],verbs:["ambled","assembled","burst","babbled","charged","chewed","clamored","coasted","crawled","crept","danced","dashed","drove","flopped","galloped","gathered","glided","hobbled","hopped","hurried","hustled","jogged","juggled","jumped","laughed","marched","meandered","munched","passed","plodded","pranced","ran","raced","rushed","sailed","sang","sauntered","scampered","scurried","skipped","slogged","slurped","spied","sprinted","spurted","squiggled","squirmed","stretched","strode","strut","swam","swung","traveled","trudged","tumbled","twisted","wade","wandered","whistled","wiggled","wobbled","yawned","zipped","zoomed"],adverbs:["absentmindedly","adventurously","angrily","anxiously","awkwardly","bashfully","beautifully","bleakly","blissfully","boastfully","boldly","bravely","briskly","calmly","carefully","cautiously","cheerfully","cleverly","cluelessly","clumsily","coaxingly","colorfully","coolly","courageously","curiously","daintily","defiantly","deliberately","delightfully","diligently","dreamily","drudgingly","eagerly","effortlessly","elegantly","energetically","enthusiastically","excitedly","fervently","foolishly","furiously","gallantly","gently","gladly","gleefully","gracefully","gratefully","happily","hastily","haphazardly","hungrily","innocently","inquisitively","intensely","jokingly","joshingly","joyously","jovially","jubilantly","kiddingly","knavishly","knottily","kookily","lazily","loftily","longingly","lovingly","loudly","loyally","madly","majestically","merrily","mockingly","mysteriously","nervously","noisily","obnoxiously","oddly","optimistically","overconfidently","outside","owlishly","patiently","playfully","politely","powerfully","purposefully","quaintly","quarrelsomely","queasily","quickly","quietly","quirkily","quizzically","rapidly","reassuringly","recklessly","reluctantly","reproachfully","sadly","scarily","seriously","shakily","sheepishly","shyly","silently","sillily","sleepily","slowly","speedily","stealthily","sternly","suspiciously","sweetly","tenderly","tensely","thoughtfully","triumphantly","unabashedly","unaccountably","urgently","vainly","valiantly","victoriously","warmly","wearily","youthfully","zestfully"]}},function(e,t,n){"use strict";var r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier(),r.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},r.splitSections=function(e){return e.split("\nm=").map(function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"})},r.getDescription=function(e){var t=r.splitSections(e);return t&&t[0]},r.getMediaSections=function(e){var t=r.splitSections(e);return t.shift(),t},r.matchPrefix=function(e,t){return r.splitLines(e).filter(function(e){return 0===e.indexOf(t)})},r.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;case"ufrag":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:n[t[r]]=t[r+1]}return n},r.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},r.parseIceOptions=function(e){return e.substr(14).split(" ")},r.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},r.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},r.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},r.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},r.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)n[(t=r[i].trim().split("="))[0].trim()]=t[1];return n},r.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach(function(t){e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)}),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},r.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},r.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},r.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},r.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map(function(e){return parseInt(e,10)})}},r.getMid=function(e){var t=r.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},r.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},r.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:r.matchPrefix(e+t,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),n},r.getIceParameters=function(e,t){var n=r.splitLines(e);return{usernameFragment:(n=n.concat(r.splitLines(t))).filter(function(e){return 0===e.indexOf("a=ice-ufrag:")})[0].substr(12),password:n.filter(function(e){return 0===e.indexOf("a=ice-pwd:")})[0].substr(10)}},r.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},r.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=r.splitLines(e)[0].split(" "),i=3;i<n.length;i++){var o=n[i],a=r.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(a){var s=r.parseRtpMap(a),c=r.matchPrefix(e,"a=fmtp:"+o+" ");switch(s.parameters=c.length?r.parseFmtp(c[0]):{},s.rtcpFeedback=r.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(r.parseRtcpFb),t.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(s.name.toUpperCase())}}}return r.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(r.parseExtmap(e))}),t},r.writeRtpDescription=function(e,t){var n="";n+="m="+e+" ",n+=t.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){n+=r.writeRtpMap(e),n+=r.writeFmtp(e),n+=r.writeRtcpFb(e)});var i=0;return t.codecs.forEach(function(e){e.maxptime>i&&(i=e.maxptime)}),i>0&&(n+="a=maxptime:"+i+"\r\n"),n+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach(function(e){n+=r.writeExtmap(e)}),n},r.parseRtpEncodingParameters=function(e){var t,n=[],i=r.parseRtpParameters(e),o=-1!==i.fecMechanisms.indexOf("RED"),a=-1!==i.fecMechanisms.indexOf("ULPFEC"),s=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),c=s.length>0&&s[0].ssrc,u=r.matchPrefix(e,"a=ssrc-group:FID").map(function(e){return e.substr(17).split(" ").map(function(e){return parseInt(e,10)})});u.length>0&&u[0].length>1&&u[0][0]===c&&(t=u[0][1]),i.codecs.forEach(function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var r={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&t&&(r.rtx={ssrc:t}),n.push(r),o&&((r=JSON.parse(JSON.stringify(r))).fec={ssrc:c,mechanism:a?"red+ulpfec":"red"},n.push(r))}}),0===n.length&&c&&n.push({ssrc:c});var l=r.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substr(5),10)*.95-16e3:void 0,n.forEach(function(e){e.maxBitrate=l})),n},r.parseRtcpParameters=function(e){var t={},n=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);var i=r.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=i.length>0,t.compound=0===i.length;var o=r.matchPrefix(e,"a=rtcp-mux");return t.mux=o.length>0,t},r.parseMsid=function(e){var t,n=r.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(t=n[0].substr(7).split(" "))[0],track:t[1]};var i=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"msid"===e.attribute});return i.length>0?{stream:(t=i[0].value.split(" "))[0],track:t[1]}:void 0},r.generateSessionId=function(){return Math.random().toString().substr(2,21)},r.writeSessionBoilerplate=function(e,t,n){var i=void 0!==t?t:2;return"v=0\r\no="+(n||"thisisadapterortc")+" "+(e||r.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.writeMediaSection=function(e,t,n,i){var o=r.writeRtpDescription(e.kind,t);if(o+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",e.direction?o+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var a="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+a,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),o},r.getDirection=function(e,t){for(var n=r.splitLines(e),i=0;i<n.length;i++)switch(n[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[i].substr(2)}return t?r.getDirection(t):"sendrecv"},r.getKind=function(e){return r.splitLines(e)[0].split(" ")[0].substr(2)},r.isRejected=function(e){return"0"===e.split(" ",2)[1]},r.parseMLine=function(e){var t=r.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},r.parseOLine=function(e){var t=r.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},r.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=r.splitLines(e),n=0;n<t.length;n++)if(t[n].length<2||"="!==t[n].charAt(1))return!1;return!0},e.exports=r},function(e,t,n){(function(e,t){!function(){var r;"undefined"!=typeof window&&(r=window),void 0!==e&&(r=e);var i=(r=r||{}).console||{log:function(){}};function o(e,t){return t?n(13)(e):e.slice?o[r(e)]:function(t,n){e(t={exports:{}}),o[r(n)]=t.exports};function r(e){return e.split("/").slice(-1).toString().replace(".js","")}}var a=t;o(function(e){var t={fn:{is:function(e){return!!e&&"function"==typeof e}}};t.bi={is:function(e){return e instanceof Boolean||"boolean"==typeof e}},t.num={is:function(e){return!r(e)&&(e-parseFloat(e)+1>=0||1/0===e||-1/0===e)}},t.text={is:function(e){return"string"==typeof e}},t.text.ify=function(e){return t.text.is(e)?e:"undefined"!=typeof JSON?JSON.stringify(e):e&&e.toString?e.toString():e},t.text.random=function(e,t){var n="";for(e=e||24,t=t||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";e>0;)n+=t.charAt(Math.floor(Math.random()*t.length)),e--;return n},t.text.match=function(e,n){var r=!1;if(e=e||"",n=t.text.is(n)?{"=":n}:n||{},t.obj.has(n,"~")&&(e=e.toLowerCase(),n["="]=(n["="]||n["~"]).toLowerCase()),t.obj.has(n,"="))return e===n["="];if(t.obj.has(n,"*")){if(e.slice(0,n["*"].length)!==n["*"])return!1;r=!0,e=e.slice(n["*"].length)}if(t.obj.has(n,"!")){if(e.slice(-n["!"].length)!==n["!"])return!1;r=!0}if(t.obj.has(n,"+")&&t.list.map(t.list.is(n["+"])?n["+"]:[n["+"]],function(t){if(!(e.indexOf(t)>=0))return!0;r=!0}))return!1;if(t.obj.has(n,"-")&&t.list.map(t.list.is(n["-"])?n["-"]:[n["-"]],function(t){if(!(e.indexOf(t)<0))return!0;r=!0}))return!1;if(t.obj.has(n,">")){if(!(e>n[">"]))return!1;r=!0}if(t.obj.has(n,"<")){if(!(e<n["<"]))return!1;r=!0}if(t.obj.has(n,"?")){if(!function(e,t){for(var n,r=-1,i=0;n=t[i++];)if(!~(r=e.indexOf(n,r+1)))return!1;return!0}(e,n["?"]))return!1;r=!0}return r},t.list={is:function(e){return e instanceof Array}},t.list.slit=Array.prototype.slice,t.list.sort=function(e){return function(t,n){return t&&n?(t=t[e])<(n=n[e])?-1:t>n?1:0:0}},t.list.map=function(e,t,n){return s(e,t,n)},t.list.index=1,t.obj={is:function(e){return!!e&&(e instanceof Object&&e.constructor===Object||"Object"===Object.prototype.toString.call(e).match(/^\[object (\w+)\]$/)[1])}},t.obj.put=function(e,t,n){return(e||{})[t]=n,e},t.obj.has=function(e,t){return e&&Object.prototype.hasOwnProperty.call(e,t)},t.obj.del=function(e,t){if(e)return e[t]=null,delete e[t],e},t.obj.as=function(e,t,n,r){return e[t]=e[t]||(r===n?{}:n)},t.obj.ify=function(e){if(o(e))return e;try{e=JSON.parse(e)}catch(t){e={}}return e},function(){var e;function n(t,n){a(this,n)&&e!==this[n]||(this[n]=t)}t.obj.to=function(e,t){return s(e,n,t=t||{}),t}}(),t.obj.copy=function(e){return e?JSON.parse(JSON.stringify(e)):e},function(){function e(e,t){var n=this.n;if(!n||!(t===n||o(n)&&a(n,t)))return!!t||void 0}t.obj.empty=function(t,n){return!t||!s(t,e,{n:n})}}(),function(){function e(t,n){if(2===arguments.length)return e.r=e.r||{},void(e.r[t]=n);e.r=e.r||[],e.r.push(t)}var i=Object.keys;t.obj.map=function(s,c,u){var l,f,p,d,h,m=0,g=n(c);if(e.r=null,i&&o(s)&&(d=i(s),h=!0),r(s)||d)for(f=(d||s).length;m<f;m++){var v=m+t.list.index;if(g){if((p=h?c.call(u||this,s[d[m]],d[m],e):c.call(u||this,s[m],v,e))!==l)return p}else if(c===s[h?d[m]:m])return d?d[m]:v}else for(m in s)if(g){if(a(s,m)&&(p=u?c.call(u,s[m],m,e):c(s[m],m,e))!==l)return p}else if(c===s[m])return m;return g?e.r:t.list.index?0:-1}}(),t.time={},t.time.is=function(e){return e?e instanceof Date:+(new Date).getTime()};var n=t.fn.is,r=t.list.is,i=t.obj,o=i.is,a=i.has,s=i.map;e.exports=t})(o,"./type"),o(function(e){e.exports=function e(t,n,r){if(!t)return{to:e};t=(this.tag||(this.tag={}))[t]||(this.tag[t]={tag:t,to:e._={next:function(e){var t;(t=this.to)&&t.next(e)}}});if(n instanceof Function){var i={off:e.off||(e.off=function(){if(this.next===e._.next)return!0;this===this.the.last&&(this.the.last=this.back),this.to.back=this.back,this.next=e._.next,this.back.to=this.to,this.the.last===this.the&&delete this.on.tag[this.the.tag]}),to:e._,next:n,the:t,on:this,as:r};return(i.back=t.last||t).to=i,t.last=i}return(t=t.to)&&void 0!==n&&t.next(n),t}})(o,"./onto"),o(function(e){if("undefined"==typeof JSON)throw new Error("JSON is not included in this browser. Please load it first: ajax.cdnjs.com/ajax/libs/json2/20110223/json2.js");var t=JSON.stringify;e.exports=function(e,n,r,i,o){if(e<n)return{defer:!0};if(n<r)return{historical:!0};if(r<n)return{converge:!0,incoming:!0};if(n===r){if((i=t(i)||"")===(o=t(o)||""))return{state:!0};if(i<o)return{converge:!0,current:!0};if(o<i)return{converge:!0,incoming:!0}}return{err:"Invalid CRDT Data: "+i+" to "+o+" at "+n+" to "+r+"!"}}})(o,"./HAM"),o(function(e){var t=o("./type"),n={is:function(e){return void 0!==e&&(null===e||e!==1/0&&(!!(s(e)||i(e)||a(e))||(n.rel.is(e)||!1)))}};n.link=n.rel={_:"#"},function(){function e(e,t){var n=this;return n.id?n.id=!1:t==r&&s(e)?void(n.id=e):n.id=!1}n.rel.is=function(t){if(t&&t[r]&&!t._&&u(t)){var n={};if(f(t,e,n),n.id)return n.id}return!1}}(),n.rel.ify=function(e){return l({},r,e)},t.obj.has._=".";var r=n.link._,i=t.bi.is,a=t.num.is,s=t.text.is,c=t.obj,u=c.is,l=c.put,f=c.map;e.exports=n})(o,"./val"),o(function(e){var t=o("./type"),n=o("./val"),r={_:"_",soul:function(e,t){return e&&e._&&e._[t||l]}};r.soul.ify=function(e,t){return t="string"==typeof t?{soul:t}:t||{},(e=e||{})._=e._||{},e._[l]=t.soul||e._[l]||u(),e},r.soul._=n.link._,function(){function e(e,t){if(t!==r._)return!n.is(e)||void(this.cb&&this.cb.call(this.as,e,t,this.n,this.s))}r.is=function(t,n,i){var o;return!!a(t)&&(!!(o=r.soul(t))&&!c(t,e,{as:i,cb:n,s:o,n:t}))}}(),function(){function e(e,t){var r,i=this.o;i.map?void 0===(r=i.map.call(this.as,e,""+t,i.node))?s(i.node,t):i.node&&(i.node[t]=r):n.is(e)&&(i.node[t]=e)}r.ify=function(t,n,i){return n?"string"==typeof n?n={soul:n}:n instanceof Function&&(n={map:n}):n={},n.map&&(n.node=n.map.call(i,t,void 0,n.node||{})),(n.node=r.soul.ify(n.node||{},n))&&c(t,e,{o:n,as:i}),n.node}}();var i=t.obj,a=i.is,s=i.del,c=i.map,u=t.text.random,l=r.soul._;e.exports=r})(o,"./node"),o(function(e){var t=o("./type"),n=o("./node");function r(){var e;return e=i(),a<e?(s=0,a=e+r.drift):a=e+(s+=1)/c+r.drift}var i=t.time.is,a=-1/0,s=0,c=1e3,u="undefined"!=typeof performance&&(performance.timing&&performance);u&&u.timing&&u.timing.navigationStart||(u=!1);r._=">",r.drift=0,r.is=function(e,t,n){var i=t&&e&&e[b]&&e[b][r._]||n;if(i)return v(i=i[t])?i:-1/0},r.lex=function(){return r().toString(36).replace(".","")},r.ify=function(e,t,i,o,a){if(!e||!e[b]){if(!a)return;e=n.soul.ify(e,a)}var s=p(e[b],r._);return l!==t&&t!==b&&(v(i)&&(s[t]=i),l!==o&&(e[t]=o)),e},r.to=function(e,t,i){var o=(e||{})[t];return h(o)&&(o=g(o)),r.ify(i,t,r.is(e,t),o,n.soul(e))},function(){function e(e,t){b!==t&&r.ify(this.o,t,this.s)}r.map=function(t,n,i){var o,a=h(a=t||n)?a:null;return t=y(t=t||n)?t:null,a&&!t?(n=v(n)?n:r(),a[b]=a[b]||{},m(a,e,{o:a,s:n}),a):(i=i||h(n)?n:o,n=v(n)?n:r(),function(r,a,s,c){if(!t)return e.call({o:s,s:n},r,a),r;t.call(i||this||{},r,a,s,c),d(s,a)&&o===s[a]||e.call({o:s,s:n},r,a)})}}();var l,f=t.obj,p=f.as,d=f.has,h=f.is,m=f.map,g=f.copy,v=t.num.is,y=t.fn.is,b=n._;e.exports=r})(o,"./state"),o(function(e){var t=o("./type"),n=o("./val"),r=o("./node"),i={};!function(){function e(e,n){if(!e||n!==r.soul(e)||!r.is(e,this.fn,this.as))return!0;this.cb&&(t.n=e,t.as=this.as,this.cb.call(t.as,e,n,t))}function t(e){e&&r.is(t.n,e,t.as)}i.is=function(t,n,r,i){return!(!t||!c(t)||f(t))&&!d(t,e,{cb:n,fn:r,as:i})}}(),function(){function e(e,t){var i;return(i=function(e,t){var n,r=e.seen,i=r.length;for(;i--;)if(n=r[i],t.obj===n.obj)return n;r.push(t)}(e,t))?i:(t.env=e,t.soul=s,r.ify(t.obj,o,t)&&(t.rel=t.rel||n.rel.ify(r.soul(t.node)),t.obj!==e.shell&&(e.graph[n.rel.is(t.rel)]=t.node)),t)}function o(t,i,o){var s,c,p=this,d=p.env;if(r._===i&&l(t,n.rel._))return o._;if(s=f(t,i,o,p,d)){if(i||(p.node=p.node||o||{},l(t,r._)&&r.soul(t)&&(p.node._=h(t._)),p.node=r.soul.ify(p.node,n.rel.is(p.rel)),p.rel=p.rel||n.rel.ify(r.soul(p.node))),(c=d.map)&&(c.call(d.as||{},t,i,o,p),l(o,i))){if(t=o[i],a===t)return void u(o,i);if(!(s=f(t,i,o,p,d)))return}if(!i)return p.node;if(!0===s)return t;if((c=e(d,{obj:t,path:p.path.concat(i)})).node)return c.rel}}function s(e){var t=this,i=n.link.is(t.rel),o=t.env.graph;t.rel=t.rel||n.rel.ify(e),t.rel[n.rel._]=e,t.node&&t.node[r._]&&(t.node[r._][n.rel._]=e),l(o,i)&&(o[e]=o[i],u(o,i))}function f(e,r,i,o,a){var s;return!!n.is(e)||(c(e)?1:(s=a.invalid)?f(e=s.call(a.as||{},e,r,i),r,i,o,a):(a.err="Invalid value at '"+o.path.concat(r).join(".")+"'!",void(t.list.is(e)&&(a.err+=" Use `.set(item)` instead of an Array."))))}i.ify=function(t,r,i){var o={path:[],obj:t};return r?"string"==typeof r?r={soul:r}:r instanceof Function&&(r.map=r):r={},r.soul&&(o.rel=n.rel.ify(r.soul)),r.shell=(i||{}).shell,r.graph=r.graph||{},r.seen=r.seen||[],r.as=r.as||i,e(r,o),r.root=o.node,r.graph}}(),i.node=function(e){var t=r.soul(e);if(t)return p({},t,e)},function(){function e(e,t){var o,a;if(r._!==t)(o=n.rel.is(e))?(a=this.opt.seen[o])?this.obj[t]=a:this.obj[t]=this.opt.seen[o]=i.to(this.graph,o,this.opt):this.obj[t]=e;else{if(f(e,n.rel._))return;this.obj[t]=h(e)}}i.to=function(t,n,r){if(t){var i={};return r=r||{seen:{}},d(t[n],e,{obj:i,graph:t,opt:r}),i}}}();t.fn.is;var a,s=t.obj,c=s.is,u=s.del,l=s.has,f=s.empty,p=s.put,d=s.map,h=s.copy;e.exports=i})(o,"./graph"),o(function(e){o("./onto"),e.exports=function(e,t){if(this.on){if(!(e instanceof Function)){if(!e||!t)return;var n=e["#"]||e,r=(this.tag||empty)[n];if(!r)return;return r=this.on(n,t),clearTimeout(r.err),!0}n=t&&t["#"]||Math.random().toString(36).slice(2);if(!e)return n;var i=this.on(n,e,t);return i.err=i.err||setTimeout(function(){i.next({err:"Error: No ACK received yet.",lack:!0}),i.off()},(this.opt||{}).lack||9e3),n}}})(o,"./ask"),o(function(e){var t=o("./type");var n=t.time.is;e.exports=function(e){var r={s:{}};return e=e||{max:1e3,age:9e3},r.check=function(e){var t;return!!(t=r.s[e])&&(t.pass?t.pass=!1:r.track(e))},r.track=function(i,o){var a=r.s[i]||(r.s[i]={});return a.was=n(),o&&(a.pass=!0),r.to||(r.to=setTimeout(function(){var i=n();t.obj.map(r.s,function(n,o){n&&e.age>i-n.was||t.obj.del(r.s,o)}),r.to=null},e.age+9)),a},r}})(o,"./dup"),o(function(e){function t(e){return e instanceof t?(this._={gun:this,$:this}).$:this instanceof t?t.create(this._={gun:this,$:this,opt:e}):new t(e)}t.is=function(e){return e instanceof t||e&&e._&&e===e._.$||!1},t.version=.9,t.chain=t.prototype,t.chain.toJSON=function(){};var n=o("./type");n.obj.to(n,t),t.HAM=o("./HAM"),t.val=o("./val"),t.node=o("./node"),t.state=o("./state"),t.graph=o("./graph"),t.on=o("./onto"),t.ask=o("./ask"),t.dup=o("./dup"),function(){function e(n){var i,o,a=this.as,s=a.at||a,c=s.$;(o=n["#"])||(o=n["#"]=l(9)),(i=s.dup).check(o)?a.out===n.out&&(n.out=r,this.to.next(n)):(i.track(o),s.ask(n["@"],n)||(n.get&&t.on.get(n,c),n.put&&t.on.put(n,c)),this.to.next(n),a.out||(n.out=e,s.on("out",n)))}t.create=function(n){n.root=n.root||n,n.graph=n.graph||{},n.on=n.on||t.on,n.ask=n.ask||t.ask,n.dup=n.dup||t.dup();var r=n.$.opt(n.opt);return n.once||(n.on("in",e,n),n.on("out",e,{at:n,out:e}),t.on("create",n),n.on("create",n)),n.once=1,r}}(),function(){function e(e,n,r,i){var o=this,a=t.state.is(r,n);if(!a)return o.err="Error: No state on '"+n+"' in node '"+i+"'!";var s=o.graph[i]||b,c=t.state.is(s,n,!0),u=s[n],l=t.HAM(o.machine,a,c,e,u);l.incoming?(o.put[i]=t.state.to(r,n,o.put[i]),(o.diff||(o.diff={}))[i]=t.state.to(r,n,o.diff[i]),o.souls[i]=!0):l.defer&&(o.defer=a<(o.defer||1/0)?a:o.defer)}function n(e,t){var n=this,r=n.$._,s=(r.next||b)[t];if(!s){if(!(r.opt||b).super)return void(n.souls[t]=!1);s=n.$.get(t)._}var c=n.map[t]={put:e,get:t,$:s.$},u={ctx:n,msg:c};n.async=!!r.tag.node,n.ack&&(c["@"]=n.ack),m(e,i,u),n.async&&(n.and||r.on("node",function(e){this.to.next(e),e===n.map[e.get]&&(n.souls[e.get]=!1,m(e.put,o,e),m(n.souls,function(e){if(e)return e})||n.c||(n.c=1,this.off(),m(n.map,a,n)))}),n.and=!0,r.on("node",c))}function i(e,n){var r=this.ctx,i=r.graph,o=this.msg,a=o.get,s=o.put,c=o.$._;i[a]=t.state.to(s,n,i[a]),r.async||(c.put=t.state.to(s,n,c.put))}function o(e,n){var r=this.put,i=this.$._;i.put=t.state.to(r,n,i.put)}function a(e,t){e.$&&(this.cat.stop=this.stop,e.$._.on("in",e),this.cat.stop=null)}t.on.put=function(i,o){var s=o._,c={$:o,graph:s.graph,put:{},map:{},souls:{},machine:t.state(),ack:i["@"],cat:s,stop:{}};if(t.graph.is(i.put,null,e,c)||(c.err="Error: Invalid graph!"),c.err)return s.on("in",{"@":i["#"],err:t.log(c.err)});m(c.put,n,c),c.async||m(c.map,a,c),r!==c.defer&&setTimeout(function(){t.on.put(i,o)},c.defer-c.machine),c.diff&&s.on("put",h(i,{put:c.diff}))},t.on.get=function(e,n){var r=n._,i=e.get,o=i[v],a=r.graph[o],s=i[y],c=(r.next||(r.next={}))[o];if(d(o,"*")){var u={};t.obj.map(r.graph,function(e,n){t.text.match(n,o)&&(u[n]=t.obj.copy(e))}),t.obj.empty(u)||r.on("in",{"@":e["#"],how:"*",put:u,$:n})}if(!a)return r.on("get",e);if(s){if(!d(a,s))return r.on("get",e);a=t.state.to(a,s)}else a=t.obj.copy(a);a=t.graph.node(a),(c||b).ack,r.on("in",{"@":e["#"],how:"mem",put:a,$:n}),r.on("get",e)}}(),t.chain.opt=function(e){e=e||{};var n=this._,r=e.peers||e;return p(e)||(e={}),p(n.opt)||(n.opt=e),u(r)&&(r=[r]),s(r)&&(r=m(r,function(e,t,n){n(e,{url:e})}),p(n.opt.peers)||(n.opt.peers={}),n.opt.peers=h(r,n.opt.peers)),n.opt.peers=n.opt.peers||{},h(e,n.opt),t.on("opt",n),n.opt.uuid=n.opt.uuid||function(){return g()+l(12)},this};var r,s=t.list.is,c=t.text,u=c.is,l=c.random,f=t.obj,p=f.is,d=f.has,h=f.to,m=f.map,g=(f.copy,t.state.lex),v=t.val.rel._,y=".",b=(t.node._,t.val.link.is,{});i.debug=function(e,t){return i.debug.i&&e===i.debug.i&&i.debug.i++&&(i.log.apply(i,arguments)||t)},t.log=function(){return!t.log.off&&i.log.apply(i,arguments),[].slice.call(arguments).join(" ")},t.log.once=function(e,n,r){return(r=t.log.once)[e]=r[e]||0,r[e]++||t.log(n)},t.log.once("welcome","Hello wonderful person! :) Thanks for using GUN, feel free to ask for help on https://gitter.im/amark/gun and ask StackOverflow questions tagged with 'gun'!"),"undefined"!=typeof window&&((window.GUN=window.Gun=t).window=window);try{void 0!==a&&(a.exports=t)}catch(e){}e.exports=t})(o,"./root"),o(function(e){var t=o("./root");t.chain.back=function(e,i){if(-1===(e=e||1)||1/0===e)return this._.root.$;if(1===e)return(this._.back||this._).$;var o=this._;if("string"==typeof e&&(e=e.split(".")),e instanceof Array){for(var a=0,s=e.length,c=o;a<s;a++)c=(c||r)[e[a]];return n!==c?i?this:c:(c=o.back)?c.$.back(e,i):void 0}if(e instanceof Function){var u;for(c={back:o};(c=c.back)&&n===(u=e(c,i)););return u}return t.num.is(e)?(o.back||o).$.back(e-1):this};var n,r={}})(o,"./back"),o(function(e){var t=o("./root");function n(e){var n,r,i,o=this.as,a=o.back,s=o.root;if(e.$||(e.$=o.$),this.to.next(e),r=e.get){if(r["#"]||o.soul){if(r["#"]=r["#"]||o.soul,e["#"]||(e["#"]=y(9)),a=s.$.get(r["#"])._,r=r["."]){if(h(a.put,r)&&((i=(n=a.$.get(r)._).ack)||(n.ack=-1),a.on("in",{$:a.$,put:t.state.to(a.put,r),get:a.get}),i))return}else{if((i=a.ack)||(a.ack=-1),h(a,"put")&&a.on("in",a),i)return;e.$=a.$}return s.ask(l,e),s.on("in",e)}if(s.now&&(s.now[o.id]=s.now[o.id]||!0,o.pass={}),r["."])return o.get?(e={get:{".":o.get},$:o.$},a.ask||(a.ask={}),a.ask[o.get]=e.$._,a.on("out",e)):(e={get:{},$:o.$},a.on("out",e));if(o.ack=o.ack||-1,o.get)return e.$=o.$,r["."]=o.get,(a.ask||(a.ask={}))[o.get]=e.$._,a.on("out",e)}return a.on("out",e)}function r(e){var n,r,o=this,s=o.as,l=s.root,d=(e.$||p)._||p,y=e.put;if(s.get&&e.get!==s.get&&(e=g(e,{get:s.get})),s.has&&d!==s&&(e=g(e,{$:s.$}),d.ack&&(s.ack=d.ack)),f===y){if(r=d.put,o.to.next(e),s.soul)return;if(f===r&&f!==d.put)return;return a(s,e,o),s.has&&u(s,e),m(d.echo,s.id),void m(s.map,d.id)}if(s.soul)return o.to.next(e),a(s,e,o),void(s.next&&v(y,c,{msg:e,cat:s}));if(!(n=t.val.link.is(y)))return t.val.is(y)?(s.has||s.soul?u(s,e):(d.has||d.soul)&&((d.echo||(d.echo={}))[s.id]=d.echo[d.id]||s,(s.map||(s.map={}))[d.id]=s.map[d.id]||{at:d}),o.to.next(e),void a(s,e,o)):(s.has&&d!==s&&h(d,"put")&&(s.put=d.put),(n=t.node.soul(y))&&d.has&&(d.put=s.root.$.get(n)._.put),r=(l.stop||{})[d.id],o.to.next(e),i(s,e,d,n),a(s,e,o),void(s.next&&v(y,c,{msg:e,cat:s})));l.stop;(r=(r=l.stop||{})[d.id]||(r[d.id]={})).is=r.is||d.put,r[s.id]=d.put||!0,o.to.next(e),i(s,e,d,n),a(s,e,o)}t.chain.chain=function(e){var i,o=this._,a=new(e||this).constructor(this),s=a._;return s.root=i=o.root,s.id=++i.once,s.back=this._,s.on=t.on,s.on("in",r,s),s.on("out",n,s),a};function i(e,n,r,o){if(o&&b!==e.get){var a=e.root.$.get(o)._;e.has?r=a:r.has&&i(r,n,r,o),r!==e&&(r.$||(r={}),(r.echo||(r.echo={}))[e.id]=r.echo[e.id]||e,e.has&&!(e.map||p)[r.id]&&u(e,n),(o!==(a=r.id?(e.map||(e.map={}))[r.id]=e.map[r.id]||{at:r}:{}).link||a.pass||e.pass)&&(e.pass&&(t.obj.map(e.map,function(e){e.pass=!0}),m(e,"pass")),a.pass&&m(a,"pass"),e.has&&(e.link=o),function(e,n){var r=e.root.$.get(n)._;if(e.ack&&(r.on("out",{get:{"#":n}}),!e.ask))return;r=e.ask,t.obj.del(e,"ask"),v(r||e.next,function(e,t){e.on("out",{get:{"#":n,".":t}})}),t.obj.del(e,"ask")}(e,a.link=o)))}}function a(e,t,n){e.echo&&v(e.echo,s,t)}function s(e){e&&e.on&&e.on("in",this)}function c(e,n){var r,i,o,a=this.cat.next||p,s=this.msg;(b!==n||a[n])&&(i=a[n])&&(i.has?(f!==i.put&&t.val.link.is(e)||(i.put=e),r=i.$):(o=s.$)&&(o=(r=s.$.get(n))._,f!==o.put&&t.val.link.is(e)||(o.put=e)),i.on("in",{put:e,get:n,$:r,via:s}))}function u(e,n){if(e.has||e.soul){var r=e.map;e.root;e.map=null,e.has&&(e.dub&&e.root.stop&&(e.dub=null),e.link=null),(e.pass||n["@"]||null!==r)&&(f===r&&t.val.link.is(e.put)||(v(r,function(t){(t=t.at)&&m(t.echo,e.id)}),r=e.put,v(e.next,function(t,n){if(f===r&&f!==e.put)return!0;t.put=f,t.ack&&(t.ack=-1),t.on("in",{get:n,$:t.$,put:f})})))}}function l(e,n){var r=this.as,i=r.get||p,o=r.$._,a=(e.put||p)[i["#"]];if(o.ack&&(o.ack=o.ack+1||1),!e.put||i["."]&&!h(a,o.get)){if(o.put!==f)return;o.on("in",{get:o.get,put:o.put=f,$:o.$,"@":e["@"]})}else b!=i["."]?t.on.put(e,o.root.$):o.on("in",{get:o.get,put:t.val.link.ify(i["#"]),$:o.$,"@":e["@"]})}var f,p={},d=t.obj,h=d.has,m=(d.put,d.del),g=d.to,v=d.map,y=t.text.random,b=(t.val.rel._,t.node._)})(o,"./chain"),o(function(e){var t=o("./root");function n(e){var n,r=this,o=r.as,a=o.at.root,s=(e.$||{})._||{},u=e.put||s.put;if((n=a.now)&&r!==n[o.now])return r.to.next(e);if(r.seen&&s.id&&r.seen[s.id])return r.to.next(e);if((n=u)&&n[l._]&&(n=l.is(n))&&(n=(e.$$=s.root.gun.get(n))._,i!==n.put&&(e=c(e,{put:u=n.put}))),(n=a.mum)&&s.id){var f=s.id+(r.id||(r.id=t.text.random(9)));if(n[f])return;i===u||l.is(u)||(n[f]=!0)}o.use(e,r),r.stun?r.stun=null:r.to.next(e)}function r(e){var t=this.on;if(!e||t.soul||t.has)return this.off();if(e=(e=(e=e.$||e)._||e).id){var n;t.map;if((n=this.seen||(this.seen={}))[e])return!0;n[e]=!0}}t.chain.get=function(e,o,a){var c;if("string"!=typeof e){if(e instanceof Function){if(!0===o)return function(e,t,n,r){var o,a=e._,c=0;if(o=a.soul||a.link||a.dub)return t(o,r,a),e;return e.get(function(e,n){if(!(i===e.put&&(o=(s(a.root.opt.peers,function(e,t,n){n(t)})||[]).length)&&++c<o)){n.rid(e);var u=(u=e.$)&&u._||{};o=u.link||u.soul||l.is(e.put)||f(e.put)||u.dub,t(o,r,e,n)}},{out:{get:{".":!0}}}),e}(this,e,0,a);var d,h=(c=this)._,m=h.root,g=m.now;(a=o||{}).at=h,a.use=e,a.out=a.out||{},a.out.get=a.out.get||{},(d=h.on("in",n,a)).rid=r,(m.now={$:1})[a.now=h.id]=d;var v=m.mum;return m.mum={},h.on("out",a.out),m.mum=v,m.now=g,c}return u(e)?this.get(""+e,o,a):(g=l.is(e))?this.get(g,o,a):((a=this.chain())._.err={err:t.log("Invalid get request!",e)},o&&o.call(a,a._.err),a)}var y=this._;return(c=(y.next||p)[e])||(c=function(e,t){var n=t._,r=n.next,i=t.chain()._;r||(r=n.next={});r[i.get=e]=i,t===n.root.$?i.soul=e:(n.soul||n.has)&&(i.has=e);return i}(e,this)),c=c.$,(g=y.stun)&&(c._.stun=c._.stun||g),o&&o instanceof Function&&c.get(o,a),c};var i,a=t.obj,s=a.map,c=(a.has,t.obj.to),u=t.num.is,l=t.val.link,f=t.node.soul,p=(t.node._,{})})(o,"./get"),o(function(e){var t=o("./root");function n(e){e&&e()}function r(){var e=this;e.graph&&!m(e.stun,a)&&(e.res=e.res||function(e){e&&e()},e.res(function(){var n=e.$.back(-1)._,r=n.ask(function(r){n.root.on("ack",r),r.err&&t.log(r),r.lack||this.off(),e.ack&&e.ack(r,this)},e.opt),i=n.root.now;p.del(n.root,"now");var o=n.root.mum;n.root.mum={},e.ref._.on("out",{$:e.ref,put:e.out=e.env.graph,opt:e.opt,"#":r}),n.root.mum=o?p.to(o,n.root.mum):o,n.root.now=i},e),e.res&&e.res())}function a(e,t){if(e)return!0}function s(e,n,r,i){var o=this,a=t.is(e);!n&&i.path.length&&(o.res||y)(function(){for(var n=i.path,r=o.ref,s=(o.opt,0),u=n.length;s<u;s++)r=r.get(n[s]);a&&(r=e);var l=r._.dub;if(l||(l=t.node.soul(i.obj)))return r.back(-1).get(l),void i.soul(l);(o.stun=o.stun||{})[n]=!0,r.get(c,!0,{as:{at:i,as:o,p:n}})},{as:o,at:i})}function c(e,n,r,i){var o=(n=n.as).at;n=n.as;var a=((r||{}).$||{})._||{};e=a.dub=a.dub||e||t.node.soul(o.obj)||t.node.soul(r.put||a.put)||t.val.rel.is(r.put||a.put)||(n.via.back("opt.uuid")||t.text.random)(),i&&(i.stun=!0),e?u(a,a.dub=e,o,n):a.via.back("opt.uuid")(function(e,r){if(e)return t.log(e);u(a,a.dub=a.dub||r,o,n)})}function u(e,t,n,r){e.$.back(-1).get(t),n.soul(t),r.stun[n.path]=!1,r.batch()}function l(e,n,r,o){if(n=n.as,r.$&&r.$._)if(r.err)i.log("Please report this as an issue! Put.any.err");else{var a,s=r.$._,c=s.put,u=n.opt||{};if(!(a=n.ref)||!a._.now){if(o&&(o.stun=!0),n.ref!==n.$){if(!(a=n.$._.get||s.get))return void i.log("Please report this as an issue! Put.no.get");n.data=h({},a,n.data),a=null}if(f===c){if(!s.get)return;e||(a=s.$.back(function(e){if(e.link||e.soul)return e.link||e.soul;n.data=h({},e.get,n.data)})),s=(a=a||s.soul||s.link||s.dub)?s.root.$.get(a)._:s,n.soul=a,c=n.data}n.not||(n.soul=n.soul||e)||(n.path&&d(n.data)?n.soul=(u.uuid||n.via.back("opt.uuid")||t.text.random)():(b==s.get&&(n.soul=(s.put||g)["#"]||s.dub),n.soul=n.soul||s.soul||s.link||(u.uuid||n.via.back("opt.uuid")||t.text.random)()),n.soul)?n.ref.put(n.data,n.soul,n):n.via.back("opt.uuid")(function(e,r){if(e)return t.log(e);n.ref.put(n.data,n.soul=r,n)})}}}t.chain.put=function(e,i,o){var a,c=this,u=c._,f=u.root.$;return(o=o||{}).data=e,o.via=o.$=o.via||o.$||c,"string"==typeof i?o.soul=i:o.ack=o.ack||i,u.soul&&(o.soul=u.soul),o.soul||f===c?d(o.data)?(o.soul=o.soul||(o.not=t.node.soul(o.data)||(o.via.back("opt.uuid")||t.text.random)()),o.soul?(o.$=f.get(o.soul),o.ref=o.$,function(e){e.batch=r;var n=e.opt||{},i=e.env=t.state.map(s,n.state);if(i.soul=e.soul,e.graph=t.graph.ify(e.data,i,e),i.err)return(e.ack||v).call(e,e.out={err:t.log(i.err)}),void(e.res&&e.res());e.batch()}(o),c):(o.via.back("opt.uuid")(function(e,n){if(e)return t.log(e);(o.ref||o.$).put(o.data,o.soul=n,o)}),c)):((o.ack||v).call(o,o.out={err:t.log("Data saved to the root level of the graph must be a node (an object), not a",typeof o.data,'of "'+o.data+'"!')}),o.res&&o.res(),c):t.is(e)?(e.get(function(e,n,r){if(!e&&t.val.is(r.put))return t.log("The reference you are saving is a",typeof r.put,'"'+r.put+'", not a node (object)!');c.put(t.val.rel.ify(e),i,o)},!0),c):(u.has&&(a=t.val.link.is(e))&&(u.dub=a),o.ref=o.ref||f._===(a=u.back)?c:a.$,o.ref._.soul&&t.val.is(o.data)&&u.get?(o.data=h({},u.get,o.data),o.ref.put(o.data,o.soul,o),c):(o.ref.get(l,!0,{as:o}),o.out||(o.res=o.res||n,o.$._.stun=o.ref._.stun),c))};var f,p=t.obj,d=p.is,h=p.put,m=p.map,g={},v=function(){},y=function(e,t){e.call(t||g)},b=t.node._})(o,"./put"),o(function(e){var t=o("./root");o("./chain"),o("./back"),o("./put"),o("./get"),e.exports=t})(o,"./index"),o(function(e){var t=o("./index");function n(e,t){var n,r=e.$,o=((r||{})._||{}).put||e.put;this.at;if(i!==o){if(n=e.$$){if(n=e.$$._,i===n.put)return;o=n.put}this.change&&(o=e.put),this.as?this.ok.call(this.as,e,t):this.ok.call(r,o,e.get,e,t)}}function r(e,n,o){var a,c,l=this.as,f=(l.at,e.$),p=f._,d=p.put||e.put;(c=e.$$)&&(a=c=e.$$._,i!==a.put&&(d=a.put)),(c=n.wait)&&(c=c[p.id])&&clearTimeout(c),!o&&(i===d||p.soul||p.link||a&&!(0<a.ack))||i===d&&(c=(s(p.root.opt.peers,function(e,t,n){n(t)})||[]).length)&&!o&&(a||p).ack<=c?c=(n.wait={})[p.id]=setTimeout(function(){r.call({as:l},e,n,c||1)},l.wait||99):(a&&i===a.put&&(c=u.is(d))&&(d=t.node.ify({},c)),n.rid(e),l.ok.call(f||l.$,d,e.get))}t.chain.on=function(e,t,r,i){var o,a=this._;if("string"==typeof e)return t?(o=a.on(e,t,r||a,i),r&&r.$&&(r.subs||(r.subs=[])).push(o),this):a.on(e);var s=t;return(s=!0===s?{change:!0}:s||{}).at=a,s.ok=e,this.get(n,s),this},t.chain.val=function(e,n){return t.log.once("onceval","Future Breaking API Change: .val -> .once, apologies unexpected."),this.once(e,n)},t.chain.once=function(e,n){var o=this,a=o._,s=a.put;if(0<a.ack&&i!==s)return(e||l).call(o,s,a.get),o;if(!e){t.log.once("valonce","Chainable val is experimental, its behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it.");var c=o.chain();return c._.nix=o.once(function(){c._.on("in",o._)}),c}return(n=n||{}).ok=e,n.at=a,n.out={"#":t.text.random(9)},o.get(r,{as:n}),n.async=!0,o},t.chain.off=function(){var e,t=this._,n=t.back;if(n)return(e=n.next)&&e[t.get]&&c(e,t.get),(e=n.ask)&&c(e,t.get),(e=n.put)&&c(e,t.get),(e=t.soul)&&c(n.root.graph,e),(e=t.map)&&s(e,function(e){e.link&&n.root.$.get(e.link).off()}),(e=t.next)&&s(e,function(e){e.$.off()}),t.on("off",{}),this};var i,a=t.obj,s=a.map,c=(a.has,a.del),u=(a.to,t.val.link),l=function(){}})(o,"./on"),o(function(e){var t=o("./index");function n(e){if(!e.put||t.val.is(e.put))return this.to.next(e);this.as.nix&&this.off(),i(e.put,r,{at:this.as,msg:e}),this.to.next(e)}function r(e,t){if(s!==t){var n=this.msg.$,r=this.at,i=n.get(t)._;(i.echo||(i.echo={}))[r.id]=i.echo[r.id]||r}}t.chain.map=function(e,r,i){var o,s=this._;return e?(t.log.once("mapfn","Map functions are experimental, their behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),o=this.chain(),this.map().on(function(n,r,i,s){var c=(e||a).call(this,n,r,i,s);if(void 0!==c)return n===c?o._.on("in",i):t.is(c)?o._.on("in",c._):void o._.on("in",{get:r,put:c})}),o):(o=s.each)?o:(s.each=o=this.chain(),o._.nix=this.back("nix"),this.on("in",n,o._),o)};var i=t.obj.map,a=function(){},s=t.node._})(o,"./map"),o(function(e){var t=o("./index");t.chain.set=function(e,n,r){var i,o=this;return n=n||function(){},(r=r||{}).item=r.item||e,(i=t.node.soul(e))&&(e=t.obj.put({},i,t.val.link.ify(i))),t.is(e)?(e.get(function(e,i,a){if(!e)return n.call(o,{err:t.log('Only a node can be linked! Not "'+a.put+'"!')});o.put(t.obj.put({},e,t.val.link.ify(e)),n,r)},!0),e):(t.obj.is(e)&&(e=o.back(-1).get(i=i||t.node.soul(e)||o.back("opt.uuid")()).put(e)),o.get(i||t.state.lex()+t.text.random(7)).put(e,n,r))}})(o,"./set"),o(function(e){if("undefined"!=typeof Gun){var t;try{t=(Gun.window||function(){}).localStorage}catch(e){}t||(i.log("Warning: No localStorage exists to persist data to!"),t={setItem:function(e,t){this[e]=t},removeItem:function(e){delete this[e]},getItem:function(e){return this[e]}}),Gun.on("create",function(e){var n=this.to,r=e.opt;if(e.once)return n.next(e);r.prefix=r.file||"gun/";var i,o,a=Gun.obj.ify(t.getItem("gap/"+r.prefix))||{},s=Gun.obj.empty;if(!s(a)){var c=Gun.obj.ify(t.getItem(r.prefix))||{},u={};Gun.obj.map(a,function(e,t){Gun.obj.map(e,function(e,n){u[t]=Gun.state.to(c[t],n,u[t])})}),setTimeout(function(){e.on("out",{put:u,"#":e.ask(l)})},1)}function l(e){if(!e.err&&e.ok){var t=e["@"];setTimeout(function(){Gun.obj.map(a,function(e,n){Gun.obj.map(e,function(n,r){t===n&&delete e[r]}),s(e)&&delete a[n]}),p()},r.wait||1)}}e.on("out",function(e){e.lS||(Gun.is(e.$)&&e.put&&!e["@"]&&!s(r.peers)&&(i=e["#"],Gun.graph.is(e.put,null,f),o||(o=setTimeout(p,r.wait||1))),this.to.next(e))}),e.on("ack",l),n.next(e);var f=function(e,t,n,r){(a[r]||(a[r]={}))[t]=i},p=function(){clearTimeout(o),o=!1;try{t.setItem("gap/"+r.prefix,JSON.stringify(a))}catch(e){Gun.log(err=e||"localStorage failure")}}}),Gun.on("create",function(e){this.to.next(e);var n=e.opt;if(!e.once&&!1!==n.localStorage){n.prefix=n.file||"gun/";e.graph;var r,i={},o=0,a=Gun.obj.ify(t.getItem(n.prefix))||{};e.on("localStorage",a),e.on("put",function(e){if(this.to.next(e),Gun.graph.is(e.put,null,s),e["@"]||(i[e["#"]]=!0),(o+=1)>=(n.batch||1e3))return c();r||(r=setTimeout(c,n.wait||1))}),e.on("get",function(t){this.to.next(t);var r,i,o,s=t.get;function c(){if(s&&(r=s["#"])){var c=s["."];(i=a[r]||o)&&c&&(i=Gun.state.to(i,c)),(i||Gun.obj.empty(n.peers))&&e.on("in",{"@":t["#"],put:Gun.graph.node(i),how:"lS",lS:t.$||e.$})}}Gun.debug?setTimeout(c,1):c()});var s=function(e,t,n,r){a[r]=Gun.state.to(n,t,a[r])},c=function(s){var u;o=0,clearTimeout(r),r=!1;var l=i;i={},s&&(a=s);try{t.setItem(n.prefix,JSON.stringify(a))}catch(t){Gun.log(u=(t||"localStorage failure")+" Consider using GUN's IndexedDB plugin for RAD for more storage space, temporary example at https://github.com/amark/gun/blob/master/test/tmp/indexedDB.html ."),e.on("localStorage:error",{err:u,file:n.prefix,flush:a,retry:c})}(u||Gun.obj.empty(n.peers))&&Gun.obj.map(l,function(t,n){e.on("in",{"@":n,err:u,ok:0})})}}})}})(o,"./adapters/localStorage"),o(function(e){var t=o("../type");function n(e){var o=function(){},s=e.opt||{};return s.log=s.log||i.log,s.gap=s.gap||s.wait||1,s.pack=s.pack||.3*(s.memory?1e3*s.memory*1e3:1399e6),o.out=function(t){var n;if(this.to&&this.to.next(t),(n=t["@"])&&(n=e.dup.s[n])&&(n=n.it)&&n._)return o.say(t,n._.via,1),void(n["##"]=t["##"]);o.say(t)},e.on("create",function(n){n.opt.pid=n.opt.pid||t.text.random(9),this.to.next(n),e.on("out",o.out)}),o.hear=function(n,r){if(n){var i,a,c,u=e.dup,l=n[0];if(s.pack<=n.length)return o.say({dam:"!",err:"Message too big!"},r);try{c=JSON.parse(n)}catch(e){s.log("DAM JSON parse error",e)}if("{"===l){if(!c)return;if(u.check(i=c["#"]))return;if(u.track(i,!0).it=c,(l=c["@"])&&c.put&&(l+=a=c["##"]||(c["##"]=o.hash(c)))!=i){if(u.check(l))return;(l=u.s)[a]=l[i]}return(c._=function(){}).via=r,(l=c["><"])&&(c._.to=t.obj.map(l.split(","),function(e,t,n){n(e,!0)})),c.dam?void((l=o.hear[c.dam])&&l(c,r,e)):void e.on("in",c)}if("["!==l);else{if(!c)return;for(var f,p=0;f=c[p++];)o.hear(f,r)}}},function(){function n(e){var t=e.batch;if(t&&(e.batch=e.tail=null,t.length))try{r(JSON.stringify(t),e)}catch(e){s.log("DAM JSON stringify error",e)}}function r(e,t){var n=t.wire;try{n.send?n.send(e):t.say&&t.say(e)}catch(n){(t.queue=t.queue||[]).push(e)}}o.say=function(i,c,u){var l,f,p;if(c){if((c.wire||s.wire&&s.wire(c))&&(f=i._||a,c!==f.via&&((p=f.raw)||(p=o.raw(i)),!((l=i["@"])&&(l=e.dup.s[l])&&(l=l.it)&&l.get&&l["##"]&&l["##"]===i["##"])&&(!(l=f.to)||!l[c.url]&&!l[c.id]||u)))){if(c.batch){if(c.tail=(c.tail||0)+p.length,c.tail<=s.pack)return void c.batch.push(p);n(c)}c.batch=[],setTimeout(function(){n(c)},s.gap),r(p,c)}}else t.obj.map(s.peers,function(e){o.say(i,e)})}}(),function(){function i(e,n){var r;return n instanceof Object?(t.obj.map(Object.keys(n).sort(),a,{to:r={},on:n}),r):n}function a(e){this.to[e]=this.on[e]}o.raw=function(n){if(!n)return"";var a,l,f,p=e.dup,d=n._||{};if(f=d.raw)return f;if("string"==typeof n)return n;n["@"]&&(f=n.put)&&((l=n["##"])||(a=c(f,i)||"",l=o.hash(n,a),n["##"]=l),(f=p.s)[l=n["@"]+l]=f[n["#"]],n["#"]=l||n["#"],a&&((n=t.obj.to(n)).put=u));var h=0,m=[];t.obj.map(s.peers,function(e){if(m.push(e.url||e.id),++h>9)return!0}),n["><"]=m.join();var g=c(n);return r!==a&&(f=g.indexOf(u,g.indexOf("put")),g=g.slice(0,f-1)+a+g.slice(f+u.length+1)),d&&(d.raw=g),g},o.hash=function(e,r){return n.hash(r||c(e.put,i)||"")||e["#"]||t.text.random(9)};var c=JSON.stringify,u=":])([:"}(),o.hi=function(n){var r=n.wire||{};n.id||n.url?(s.peers[n.url||n.id]=n,t.obj.del(s.peers,r.id)):(r=r.id=r.id||t.text.random(9),o.say({dam:"?"},s.peers[r]=n)),r.hied||e.on(r.hied="hi",n),r=n.queue,n.queue=[],t.obj.map(r,function(e){o.say(e,n)})},o.bye=function(n){t.obj.del(s.peers,n.id),e.on("bye",n)},o.hear["!"]=function(e,t){s.log("Error:",e.err)},o.hear["?"]=function(e,t){if(!e.pid)return o.say({dam:"?",pid:s.pid,"@":e["#"]},t);t.id=t.id||e.pid,o.hi(t)},o}n.hash=function(e){if("string"!=typeof e)return{err:1};var t=0;if(!e.length)return t;for(var n=0,r=e.length;n<r;++n)t=(t<<5)-t+e.charCodeAt(n),t|=0;return t};var r,a={};Object.keys=Object.keys||function(e){return map(e,function(e,t,n){n(t)})};try{e.exports=n}catch(e){}})(o,"./adapters/mesh"),o(function(t){var n=o("../index");n.Mesh=o("./mesh"),n.on("opt",function(t){this.to.next(t);var r=t.opt;if(!t.once&&!1!==r.WebSocket){var i;"undefined"!=typeof window&&(i=window),void 0!==e&&(i=e),i=i||{};var o=r.WebSocket||i.WebSocket||i.webkitWebSocket||i.mozWebSocket;if(o){r.WebSocket=o;r.mesh=r.mesh||n.Mesh(t),r.wire;r.wire=a}}function a(e){try{if(!e||!e.url)return n&&n(e);var t=e.url.replace("http","ws"),n=e.wire=new r.WebSocket(t);return n.onclose=function(){r.mesh.bye(e),s(e)},n.onerror=function(t){s(e),t&&t.code},n.onopen=function(){r.mesh.hi(e)},n.onmessage=function(t){t&&r.mesh.hear(t.data||t,e)},n}catch(e){}}function s(e){clearTimeout(e.defer),e.defer=setTimeout(function(){a(e)},2e3)}})})(o,"./adapters/websocket")}()}).call(this,n(5),n(12)(e))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";var r=n(3);function i(e,t,n,i,o){var a=r.writeRtpDescription(e.kind,t);if(a+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":o||"active"),a+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?a+="a=sendrecv\r\n":e.rtpSender?a+="a=sendonly\r\n":e.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",e.rtpSender){var s=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=s;var c="msid:"+(i?i.id:"-")+" "+s+"\r\n";a+="a="+c,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+c,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+c,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),a}function o(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},i=function(e,t,n,i){var o=r(e.parameters.apt,n),a=r(t.parameters.apt,i);return o&&a&&o.name.toLowerCase()===a.name.toLowerCase()};return e.codecs.forEach(function(r){for(var o=0;o<t.codecs.length;o++){var a=t.codecs[o];if(r.name.toLowerCase()===a.name.toLowerCase()&&r.clockRate===a.clockRate){if("rtx"===r.name.toLowerCase()&&r.parameters&&a.parameters.apt&&!i(r,a,e.codecs,t.codecs))continue;(a=JSON.parse(JSON.stringify(a))).numChannels=Math.min(r.numChannels,a.numChannels),n.codecs.push(a),a.rtcpFeedback=a.rtcpFeedback.filter(function(e){for(var t=0;t<r.rtcpFeedback.length;t++)if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter)return!0;return!1});break}}}),e.headerExtensions.forEach(function(e){for(var r=0;r<t.headerExtensions.length;r++){var i=t.headerExtensions[r];if(e.uri===i.uri){n.headerExtensions.push(i);break}}}),n}function a(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function s(e,t){var n=e.getRemoteCandidates().find(function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type});return n||e.addRemoteCandidate(t),!n}function c(e,t){var n=new Error(t);return n.name=e,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],n}e.exports=function(e,t){function n(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function u(t,n,r,i){var o=new Event("track");o.track=n,o.receiver=r,o.transceiver={receiver:r},o.streams=i,e.setTimeout(function(){t._dispatchEvent("track",o)})}var l=function(n){var i=this,o=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){i[e]=o[e].bind(o)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle="max-bundle"===n.bundlePolicy,"negotiate"===n.rtcpMuxPolicy)throw c("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all"}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced"}if(n.iceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){if(e&&(e.urls||e.url)){var r=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"==typeof r;return i&&(r=[r]),r=r.filter(function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||n?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(n=!0,!0)}),delete e.url,e.urls=i?r[0]:r,!!r.length}})}(n.iceServers||[],t),this._iceGatherers=[],n.iceCandidatePoolSize)for(var a=n.iceCandidatePoolSize;a>0;a--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=r.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(l.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(l.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),l.prototype.onicecandidate=null,l.prototype.onaddstream=null,l.prototype.ontrack=null,l.prototype.onremovestream=null,l.prototype.onsignalingstatechange=null,l.prototype.oniceconnectionstatechange=null,l.prototype.onconnectionstatechange=null,l.prototype.onicegatheringstatechange=null,l.prototype.onnegotiationneeded=null,l.prototype.ondatachannel=null,l.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},l.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},l.prototype.getConfiguration=function(){return this._config},l.prototype.getLocalStreams=function(){return this.localStreams},l.prototype.getRemoteStreams=function(){return this.remoteStreams},l.prototype._createTransceiver=function(e,t){var n=this.transceivers.length>0,r={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&n)r.iceTransport=this.transceivers[0].iceTransport,r.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();r.iceTransport=i.iceTransport,r.dtlsTransport=i.dtlsTransport}return t||this.transceivers.push(r),r},l.prototype.addTrack=function(t,n){if(this._isClosed)throw c("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r;if(this.transceivers.find(function(e){return e.track===t}))throw c("InvalidAccessError","Track already exists.");for(var i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==t.kind||(r=this.transceivers[i]);return r||(r=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),r.track=t,r.stream=n,r.rtpSender=new e.RTCRtpSender(t,r.dtlsTransport),r.rtpSender},l.prototype.addStream=function(e){var n=this;if(t>=15025)e.getTracks().forEach(function(t){n.addTrack(t,e)});else{var r=e.clone();e.getTracks().forEach(function(e,t){var n=r.getTracks()[t];e.addEventListener("enabled",function(e){n.enabled=e.enabled})}),r.getTracks().forEach(function(e){n.addTrack(e,r)})}},l.prototype.removeTrack=function(t){if(this._isClosed)throw c("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find(function(e){return e.rtpSender===t});if(!n)throw c("InvalidAccessError","Sender was not created by this connection.");var r=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map(function(e){return e.stream}).indexOf(r)&&this.localStreams.indexOf(r)>-1&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},l.prototype.removeStream=function(e){var t=this;e.getTracks().forEach(function(e){var n=t.getSenders().find(function(t){return t.track===e});n&&t.removeTrack(n)})},l.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})},l.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})},l.prototype._createIceGatherer=function(t,n){var r=this;if(n&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;i.state=n?"completed":"gathering",null!==r.transceivers[t].bufferedCandidateEvents&&r.transceivers[t].bufferedCandidateEvents.push(e)},i.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),i},l.prototype._gather=function(t,n){var i=this,o=this.transceivers[n].iceGatherer;if(!o.onlocalcandidate){var a=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,o.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),o.onlocalcandidate=function(e){if(!(i.usingBundle&&n>0)){var a=new Event("icecandidate");a.candidate={sdpMid:t,sdpMLineIndex:n};var s=e.candidate,c=!s||0===Object.keys(s).length;if(c)"new"!==o.state&&"gathering"!==o.state||(o.state="completed");else{"new"===o.state&&(o.state="gathering"),s.component=1,s.ufrag=o.getLocalParameters().usernameFragment;var u=r.writeCandidate(s);a.candidate=Object.assign(a.candidate,r.parseCandidate(u)),a.candidate.candidate=u,a.candidate.toJSON=function(){return{candidate:a.candidate.candidate,sdpMid:a.candidate.sdpMid,sdpMLineIndex:a.candidate.sdpMLineIndex,usernameFragment:a.candidate.usernameFragment}}}var l=r.getMediaSections(i._localDescription.sdp);l[a.candidate.sdpMLineIndex]+=c?"a=end-of-candidates\r\n":"a="+a.candidate.candidate+"\r\n",i._localDescription.sdp=r.getDescription(i._localDescription.sdp)+l.join("");var f=i.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});"gathering"!==i.iceGatheringState&&(i.iceGatheringState="gathering",i._emitGatheringStateChange()),c||i._dispatchEvent("icecandidate",a),f&&(i._dispatchEvent("icecandidate",new Event("icecandidate")),i.iceGatheringState="complete",i._emitGatheringStateChange())}},e.setTimeout(function(){a.forEach(function(e){o.onlocalcandidate(e)})},0)}},l.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var r=new e.RTCDtlsTransport(n);return r.ondtlsstatechange=function(){t._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:r}},l.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var r=this.transceivers[e].dtlsTransport;r&&(delete r.ondtlsstatechange,delete r.onerror,delete this.transceivers[e].dtlsTransport)},l.prototype._transceive=function(e,n,i){var a=o(e.localCapabilities,e.remoteCapabilities);n&&e.rtpSender&&(a.encodings=e.sendEncodingParameters,a.rtcp={cname:r.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(a.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(a)),i&&e.rtpReceiver&&a.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach(function(e){delete e.rtx}),e.recvEncodingParameters.length?a.encodings=e.recvEncodingParameters:a.encodings=[{}],a.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(a.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(a.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(a))},l.prototype.setLocalDescription=function(e){var t,n,i=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(c("TypeError",'Unsupported type "'+e.type+'"'));if(!a("setLocalDescription",e.type,i.signalingState)||i._isClosed)return Promise.reject(c("InvalidStateError","Can not set local "+e.type+" in state "+i.signalingState));if("offer"===e.type)t=r.splitSections(e.sdp),n=t.shift(),t.forEach(function(e,t){var n=r.parseRtpParameters(e);i.transceivers[t].localCapabilities=n}),i.transceivers.forEach(function(e,t){i._gather(e.mid,t)});else if("answer"===e.type){t=r.splitSections(i._remoteDescription.sdp),n=t.shift();var s=r.matchPrefix(n,"a=ice-lite").length>0;t.forEach(function(e,t){var a=i.transceivers[t],c=a.iceGatherer,u=a.iceTransport,l=a.dtlsTransport,f=a.localCapabilities,p=a.remoteCapabilities;if(!(r.isRejected(e)&&0===r.matchPrefix(e,"a=bundle-only").length)&&!a.rejected){var d=r.getIceParameters(e,n),h=r.getDtlsParameters(e,n);s&&(h.role="server"),i.usingBundle&&0!==t||(i._gather(a.mid,t),"new"===u.state&&u.start(c,d,s?"controlling":"controlled"),"new"===l.state&&l.start(h));var m=o(f,p);i._transceive(a,m.codecs.length>0,!1)}})}return i._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?i._updateSignalingState("have-local-offer"):i._updateSignalingState("stable"),Promise.resolve()},l.prototype.setRemoteDescription=function(i){var l=this;if(-1===["offer","answer"].indexOf(i.type))return Promise.reject(c("TypeError",'Unsupported type "'+i.type+'"'));if(!a("setRemoteDescription",i.type,l.signalingState)||l._isClosed)return Promise.reject(c("InvalidStateError","Can not set remote "+i.type+" in state "+l.signalingState));var f={};l.remoteStreams.forEach(function(e){f[e.id]=e});var p=[],d=r.splitSections(i.sdp),h=d.shift(),m=r.matchPrefix(h,"a=ice-lite").length>0,g=r.matchPrefix(h,"a=group:BUNDLE ").length>0;l.usingBundle=g;var v=r.matchPrefix(h,"a=ice-options:")[0];return l.canTrickleIceCandidates=!!v&&v.substr(14).split(" ").indexOf("trickle")>=0,d.forEach(function(a,c){var u=r.splitLines(a),d=r.getKind(a),v=r.isRejected(a)&&0===r.matchPrefix(a,"a=bundle-only").length,y=u[0].substr(2).split(" ")[2],b=r.getDirection(a,h),w=r.parseMsid(a),C=r.getMid(a)||r.generateIdentifier();if(v||"application"===d&&("DTLS/SCTP"===y||"UDP/DTLS/SCTP"===y))l.transceivers[c]={mid:C,kind:d,protocol:y,rejected:!0};else{var S,T,E,_,k,R,P,x,A;!v&&l.transceivers[c]&&l.transceivers[c].rejected&&(l.transceivers[c]=l._createTransceiver(d,!0));var M,D,I=r.parseRtpParameters(a);v||(M=r.getIceParameters(a,h),(D=r.getDtlsParameters(a,h)).role="client"),P=r.parseRtpEncodingParameters(a);var j=r.parseRtcpParameters(a),O=r.matchPrefix(a,"a=end-of-candidates",h).length>0,U=r.matchPrefix(a,"a=candidate:").map(function(e){return r.parseCandidate(e)}).filter(function(e){return 1===e.component});if(("offer"===i.type||"answer"===i.type)&&!v&&g&&c>0&&l.transceivers[c]&&(l._disposeIceAndDtlsTransports(c),l.transceivers[c].iceGatherer=l.transceivers[0].iceGatherer,l.transceivers[c].iceTransport=l.transceivers[0].iceTransport,l.transceivers[c].dtlsTransport=l.transceivers[0].dtlsTransport,l.transceivers[c].rtpSender&&l.transceivers[c].rtpSender.setTransport(l.transceivers[0].dtlsTransport),l.transceivers[c].rtpReceiver&&l.transceivers[c].rtpReceiver.setTransport(l.transceivers[0].dtlsTransport)),"offer"!==i.type||v){if("answer"===i.type&&!v){T=(S=l.transceivers[c]).iceGatherer,E=S.iceTransport,_=S.dtlsTransport,k=S.rtpReceiver,R=S.sendEncodingParameters,x=S.localCapabilities,l.transceivers[c].recvEncodingParameters=P,l.transceivers[c].remoteCapabilities=I,l.transceivers[c].rtcpParameters=j,U.length&&"new"===E.state&&(!m&&!O||g&&0!==c?U.forEach(function(e){s(S.iceTransport,e)}):E.setRemoteCandidates(U)),g&&0!==c||("new"===E.state&&E.start(T,M,"controlling"),"new"===_.state&&_.start(D)),!o(S.localCapabilities,S.remoteCapabilities).codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&S.sendEncodingParameters[0].rtx&&delete S.sendEncodingParameters[0].rtx,l._transceive(S,"sendrecv"===b||"recvonly"===b,"sendrecv"===b||"sendonly"===b),!k||"sendrecv"!==b&&"sendonly"!==b?delete S.rtpReceiver:(A=k.track,w?(f[w.stream]||(f[w.stream]=new e.MediaStream),n(A,f[w.stream]),p.push([A,k,f[w.stream]])):(f.default||(f.default=new e.MediaStream),n(A,f.default),p.push([A,k,f.default])))}}else{(S=l.transceivers[c]||l._createTransceiver(d)).mid=C,S.iceGatherer||(S.iceGatherer=l._createIceGatherer(c,g)),U.length&&"new"===S.iceTransport.state&&(!O||g&&0!==c?U.forEach(function(e){s(S.iceTransport,e)}):S.iceTransport.setRemoteCandidates(U)),x=e.RTCRtpReceiver.getCapabilities(d),t<15019&&(x.codecs=x.codecs.filter(function(e){return"rtx"!==e.name})),R=S.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var L,B=!1;if("sendrecv"===b||"sendonly"===b){if(B=!S.rtpReceiver,k=S.rtpReceiver||new e.RTCRtpReceiver(S.dtlsTransport,d),B)A=k.track,w&&"-"===w.stream||(w?(f[w.stream]||(f[w.stream]=new e.MediaStream,Object.defineProperty(f[w.stream],"id",{get:function(){return w.stream}})),Object.defineProperty(A,"id",{get:function(){return w.track}}),L=f[w.stream]):(f.default||(f.default=new e.MediaStream),L=f.default)),L&&(n(A,L),S.associatedRemoteMediaStreams.push(L)),p.push([A,k,L])}else S.rtpReceiver&&S.rtpReceiver.track&&(S.associatedRemoteMediaStreams.forEach(function(t){var n,r,i=t.getTracks().find(function(e){return e.id===S.rtpReceiver.track.id});i&&(n=i,(r=t).removeTrack(n),r.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:n})))}),S.associatedRemoteMediaStreams=[]);S.localCapabilities=x,S.remoteCapabilities=I,S.rtpReceiver=k,S.rtcpParameters=j,S.sendEncodingParameters=R,S.recvEncodingParameters=P,l._transceive(l.transceivers[c],!1,B)}}}),void 0===l._dtlsRole&&(l._dtlsRole="offer"===i.type?"active":"passive"),l._remoteDescription={type:i.type,sdp:i.sdp},"offer"===i.type?l._updateSignalingState("have-remote-offer"):l._updateSignalingState("stable"),Object.keys(f).forEach(function(t){var n=f[t];if(n.getTracks().length){if(-1===l.remoteStreams.indexOf(n)){l.remoteStreams.push(n);var r=new Event("addstream");r.stream=n,e.setTimeout(function(){l._dispatchEvent("addstream",r)})}p.forEach(function(e){var t=e[0],r=e[1];n.id===e[2].id&&u(l,t,r,[n])})}}),p.forEach(function(e){e[2]||u(l,e[0],e[1],[])}),e.setTimeout(function(){l&&l.transceivers&&l.transceivers.forEach(function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},l.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},l.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},l.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout(function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}},0))},l.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++}),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",n)}},l.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)}),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var n=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",n)}},l.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(c("InvalidStateError","Can not call createOffer after close"));var o=n.transceivers.filter(function(e){return"audio"===e.kind}).length,a=n.transceivers.filter(function(e){return"video"===e.kind}).length,s=arguments[0];if(s){if(s.mandatory||s.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==s.offerToReceiveAudio&&(o=!0===s.offerToReceiveAudio?1:!1===s.offerToReceiveAudio?0:s.offerToReceiveAudio),void 0!==s.offerToReceiveVideo&&(a=!0===s.offerToReceiveVideo?1:!1===s.offerToReceiveVideo?0:s.offerToReceiveVideo)}for(n.transceivers.forEach(function(e){"audio"===e.kind?--o<0&&(e.wantReceive=!1):"video"===e.kind&&--a<0&&(e.wantReceive=!1)});o>0||a>0;)o>0&&(n._createTransceiver("audio"),o--),a>0&&(n._createTransceiver("video"),a--);var u=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach(function(i,o){var a=i.track,s=i.kind,c=i.mid||r.generateIdentifier();i.mid=c,i.iceGatherer||(i.iceGatherer=n._createIceGatherer(o,n.usingBundle));var u=e.RTCRtpSender.getCapabilities(s);t<15019&&(u.codecs=u.codecs.filter(function(e){return"rtx"!==e.name})),u.codecs.forEach(function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),i.remoteCapabilities&&i.remoteCapabilities.codecs&&i.remoteCapabilities.codecs.forEach(function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)})}),u.headerExtensions.forEach(function(e){(i.remoteCapabilities&&i.remoteCapabilities.headerExtensions||[]).forEach(function(t){e.uri===t.uri&&(e.id=t.id)})});var l=i.sendEncodingParameters||[{ssrc:1001*(2*o+1)}];a&&t>=15019&&"video"===s&&!l[0].rtx&&(l[0].rtx={ssrc:l[0].ssrc+1}),i.wantReceive&&(i.rtpReceiver=new e.RTCRtpReceiver(i.dtlsTransport,s)),i.localCapabilities=u,i.sendEncodingParameters=l}),"max-compat"!==n._config.bundlePolicy&&(u+="a=group:BUNDLE "+n.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),u+="a=ice-options:trickle\r\n",n.transceivers.forEach(function(e,t){u+=i(e,e.localCapabilities,"offer",e.stream,n._dtlsRole),u+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===n.iceGatheringState||0!==t&&n.usingBundle||(e.iceGatherer.getLocalCandidates().forEach(function(e){e.component=1,u+="a="+r.writeCandidate(e)+"\r\n"}),"completed"===e.iceGatherer.state&&(u+="a=end-of-candidates\r\n"))});var l=new e.RTCSessionDescription({type:"offer",sdp:u});return Promise.resolve(l)},l.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(c("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==n.signalingState&&"have-local-pranswer"!==n.signalingState)return Promise.reject(c("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var a=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(a+="a=group:BUNDLE "+n.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),a+="a=ice-options:trickle\r\n";var s=r.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach(function(e,r){if(!(r+1>s)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?a+="m=application 0 DTLS/SCTP 5000\r\n":a+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?a+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(a+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(a+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var c;if(e.stream)"audio"===e.kind?c=e.stream.getAudioTracks()[0]:"video"===e.kind&&(c=e.stream.getVideoTracks()[0]),c&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1});var u=o(e.localCapabilities,e.remoteCapabilities);!u.codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,a+=i(e,u,"answer",e.stream,n._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(a+="a=rtcp-rsize\r\n")}});var u=new e.RTCSessionDescription({type:"answer",sdp:a});return Promise.resolve(u)},l.prototype.addIceCandidate=function(e){var t,n=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(i,o){if(!n._remoteDescription)return o(c("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var a=e.sdpMLineIndex;if(e.sdpMid)for(var u=0;u<n.transceivers.length;u++)if(n.transceivers[u].mid===e.sdpMid){a=u;break}var l=n.transceivers[a];if(!l)return o(c("OperationError","Can not add ICE candidate"));if(l.rejected)return i();var f=Object.keys(e.candidate).length>0?r.parseCandidate(e.candidate):{};if("tcp"===f.protocol&&(0===f.port||9===f.port))return i();if(f.component&&1!==f.component)return i();if((0===a||a>0&&l.iceTransport!==n.transceivers[0].iceTransport)&&!s(l.iceTransport,f))return o(c("OperationError","Can not add ICE candidate"));var p=e.candidate.trim();0===p.indexOf("a=")&&(p=p.substr(2)),(t=r.getMediaSections(n._remoteDescription.sdp))[a]+="a="+(f.type?p:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+t.join("")}else for(var d=0;d<n.transceivers.length&&(n.transceivers[d].rejected||(n.transceivers[d].iceTransport.addRemoteCandidate({}),(t=r.getMediaSections(n._remoteDescription.sdp))[d]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+t.join(""),!n.usingBundle));d++);i()})},l.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var n=null;if(this.transceivers.forEach(function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)}),!n)throw c("InvalidAccessError","Invalid selector.");return n.getStats()}var r=[];return this.transceivers.forEach(function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(t){e[t]&&r.push(e[t].getStats())})}),Promise.all(r).then(function(e){var t=new Map;return e.forEach(function(e){e.forEach(function(e){t.set(e.id,e)})}),t})};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(t){var n=e[t];if(n&&n.prototype&&n.prototype.getStats){var r=n.prototype.getStats;n.prototype.getStats=function(){return r.apply(this).then(function(e){var t=new Map;return Object.keys(e).forEach(function(n){var r;e[n].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(r=e[n]).type]||r.type,t.set(n,e[n])}),t})}}});var f=["createOffer","createAnswer"];return f.forEach(function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then(function(t){"function"==typeof e[0]&&e[0].apply(null,[t])},function(t){"function"==typeof e[1]&&e[1].apply(null,[t])}):t.apply(this,arguments)}}),(f=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach(function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)},function(t){"function"==typeof e[2]&&e[2].apply(null,[t])}):t.apply(this,arguments)}}),["getStats"].forEach(function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)}):t.apply(this,arguments)}}),l}},function(e,t){},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var r=n(9),i=n(10),o=n(11);function a(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return f(this,e)}return u(this,e,t,n)}function u(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=p(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|h(t,n),i=(e=s(e,r)).write(t,n);i!==r&&(e=e.slice(0,i));return e}(e,t,n):function(e,t){if(c.isBuffer(t)){var n=0|d(t.length);return 0===(e=s(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?s(e,0):p(e,t);if("Buffer"===t.type&&o(t.data))return p(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function f(e,t){if(l(t),e=s(e,t<0?0:0|d(t)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function p(e,t){var n=t.length<0?0:0|d(t.length);e=s(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function d(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function h(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return $(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return G(e).length;default:if(r)return $(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function g(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:v(e,t,n,r,i);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):v(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function v(e,t,n,r,i){var o,a=1,s=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,c/=2,n/=2}function u(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var l=-1;for(o=n;o<s;o++)if(u(e,o)===u(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===c)return l*a}else-1!==l&&(o-=o-l),l=-1}else for(n+c>s&&(n=s-c),o=n;o>=0;o--){for(var f=!0,p=0;p<c;p++)if(u(e,o+p)!==u(t,p)){f=!1;break}if(f)return o}return-1}function y(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function b(e,t,n,r){return F($(t,e.length-n),e,n,r)}function w(e,t,n,r){return F(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function C(e,t,n,r){return w(e,t,n,r)}function S(e,t,n,r){return F(G(t),e,n,r)}function T(e,t,n,r){return F(function(e,t){for(var n,r,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function E(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function _(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,a,s,c,u=e[i],l=null,f=u>239?4:u>223?3:u>191?2:1;if(i+f<=n)switch(f){case 1:u<128&&(l=u);break;case 2:128==(192&(o=e[i+1]))&&(c=(31&u)<<6|63&o)>127&&(l=c);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(c=(15&u)<<12|(63&o)<<6|63&a)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(c=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&c<1114112&&(l=c)}null===l?(l=65533,f=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=f}return function(e){var t=e.length;if(t<=k)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=k));return n}(r)}t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,n){return u(null,e,t,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,n){return function(e,t,n,r){return l(t),t<=0?s(e,t):void 0!==n?"string"==typeof r?s(e,t).fill(n,r):s(e,t).fill(n):s(e,t)}(null,e,t,n)},c.allocUnsafe=function(e){return f(null,e)},c.allocUnsafeSlow=function(e){return f(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=c.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var a=e[n];if(!c.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},c.byteLength=h,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?_(this,0,e):function(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return x(this,t,n);case"utf8":case"utf-8":return _(this,t,n);case"ascii":return R(this,t,n);case"latin1":case"binary":return P(this,t,n);case"base64":return E(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,n,r,i){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(o,a),u=this.slice(r,i),l=e.slice(t,n),f=0;f<s;++f)if(u[f]!==l[f]){o=u[f],a=l[f];break}return o<a?-1:a<o?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return g(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return g(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return y(this,e,t,n);case"utf8":case"utf-8":return b(this,e,t,n);case"ascii":return w(this,e,t,n);case"latin1":case"binary":return C(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var k=4096;function R(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function P(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function x(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=N(e[o]);return i}function A(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function M(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function D(e,t,n,r,i,o){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function I(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function j(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function O(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function U(e,t,n,r,o){return o||O(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function L(e,t,n,r,o){return o||O(e,0,n,8),i.write(e,t,n,r,52,8),n+8}c.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=c.prototype;else{var i=t-e;n=new c(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+e]}return n},c.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},c.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},c.prototype.readUInt8=function(e,t){return t||M(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||M(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||M(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||M(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||M(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||M(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},c.prototype.readInt8=function(e,t){return t||M(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||M(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){t||M(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return t||M(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||M(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||M(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||M(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||M(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||M(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||D(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},c.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||D(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},c.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):I(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):I(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):j(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):j(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);D(this,e,t,n,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<n&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},c.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);D(this,e,t,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):I(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):I(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):j(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):j(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,n){return U(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return U(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return L(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return L(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,o=r-n;if(this===e&&n<t&&t<r)for(i=o-1;i>=0;--i)e[i+t]=this[i+n];else if(o<1e3||!c.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},c.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var a=c.isBuffer(e)?e:$(new c(e,r).toString()),s=a.length;for(o=0;o<n-t;++o)this[o+t]=a[o%s]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function N(e){return e<16?"0"+e.toString(16):e.toString(16)}function $(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function G(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(B,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function F(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(5))},function(e,t,n){"use strict";t.byteLength=function(e){var t=u(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){for(var t,n=u(e),r=n[0],a=n[1],s=new o(function(e,t,n){return 3*(t+n)/4-n}(0,r,a)),c=0,l=a>0?r-4:r,f=0;f<l;f+=4)t=i[e.charCodeAt(f)]<<18|i[e.charCodeAt(f+1)]<<12|i[e.charCodeAt(f+2)]<<6|i[e.charCodeAt(f+3)],s[c++]=t>>16&255,s[c++]=t>>8&255,s[c++]=255&t;2===a&&(t=i[e.charCodeAt(f)]<<2|i[e.charCodeAt(f+1)]>>4,s[c++]=255&t);1===a&&(t=i[e.charCodeAt(f)]<<10|i[e.charCodeAt(f+1)]<<4|i[e.charCodeAt(f+2)]>>2,s[c++]=t>>8&255,s[c++]=255&t);return s},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],a=0,s=n-i;a<s;a+=16383)o.push(l(e,a,a+16383>s?s:a+16383));1===i?(t=e[n-1],o.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],o.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=a.length;s<c;++s)r[s]=a[s],i[a.charCodeAt(s)]=s;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,n){for(var i,o,a=[],s=t;s<n;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return a.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,i){var o,a,s=8*i-r-1,c=(1<<s)-1,u=c>>1,l=-7,f=n?i-1:0,p=n?-1:1,d=e[t+f];for(f+=p,o=d&(1<<-l)-1,d>>=-l,l+=s;l>0;o=256*o+e[t+f],f+=p,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+e[t+f],f+=p,l-=8);if(0===o)o=1-u;else{if(o===c)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,r),o-=u}return(d?-1:1)*a*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var a,s,c,u=8*o-i-1,l=(1<<u)-1,f=l>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,h=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),(t+=a+f>=1?p/c:p*Math.pow(2,1-f))*c>=2&&(a++,c/=2),a+f>=l?(s=0,a=l):a+f>=1?(s=(t*c-1)*Math.pow(2,i),a+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;e[n+d]=255&s,d+=h,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;e[n+d]=255&a,d+=h,a/=256,u-=8);e[n+d-h]|=128*m}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=13},function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"shimGetUserMedia",function(){return b}),n.d(r,"shimGetDisplayMedia",function(){return w}),n.d(r,"shimMediaStream",function(){return S}),n.d(r,"shimOnTrack",function(){return T}),n.d(r,"shimGetSendersWithDtmf",function(){return E}),n.d(r,"shimSenderReceiverGetStats",function(){return _}),n.d(r,"shimAddTrackRemoveTrackWithNative",function(){return k}),n.d(r,"shimAddTrackRemoveTrack",function(){return R}),n.d(r,"shimPeerConnection",function(){return P}),n.d(r,"fixNegotiationNeeded",function(){return x});var i={};n.r(i),n.d(i,"shimGetUserMedia",function(){return D}),n.d(i,"shimGetDisplayMedia",function(){return I}),n.d(i,"shimPeerConnection",function(){return j}),n.d(i,"shimReplaceTrack",function(){return O});var o={};n.r(o),n.d(o,"shimGetUserMedia",function(){return U}),n.d(o,"shimGetDisplayMedia",function(){return L}),n.d(o,"shimOnTrack",function(){return B}),n.d(o,"shimPeerConnection",function(){return N}),n.d(o,"shimSenderGetStats",function(){return $}),n.d(o,"shimReceiverGetStats",function(){return G}),n.d(o,"shimRemoveStream",function(){return F}),n.d(o,"shimRTCDataChannel",function(){return z});var a={};n.r(a),n.d(a,"shimLocalStreamsAPI",function(){return Y}),n.d(a,"shimRemoteStreamsAPI",function(){return J}),n.d(a,"shimCallbacksAPI",function(){return K}),n.d(a,"shimGetUserMedia",function(){return V}),n.d(a,"shimConstraints",function(){return q}),n.d(a,"shimRTCIceServerUrls",function(){return W}),n.d(a,"shimTrackEventTransceiver",function(){return H}),n.d(a,"shimCreateOfferLegacy",function(){return Z});var s={};n.r(s),n.d(s,"shimRTCIceCandidate",function(){return ee}),n.d(s,"shimMaxMessageSize",function(){return te}),n.d(s,"shimSendThrowTypeError",function(){return ne}),n.d(s,"shimConnectionState",function(){return re}),n.d(s,"removeAllowExtmapMixed",function(){return ie});let c=!0,u=!0;function l(e,t,n){const r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}function f(e,t,n){if(!e.RTCPeerConnection)return;const r=e.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return i.apply(this,arguments);const o=e=>{const t=n(e);t&&r(t)};return this._eventMap=this._eventMap||{},this._eventMap[r]=o,i.apply(this,[e,o])};const o=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[n])return o.apply(this,arguments);const r=this._eventMap[n];return delete this._eventMap[n],o.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function p(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(c=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function d(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(u=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function h(){if("object"==typeof window){if(c)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function m(e,t){u&&console.warn(e+" is deprecated, please use "+t+" instead.")}function g(e){const{navigator:t}=e,n={browser:null,version:null};if(void 0===e||!e.navigator)return n.browser="Not a browser.",n;if(t.mozGetUserMedia)n.browser="firefox",n.version=l(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia)n.browser="chrome",n.version=l(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))n.browser="edge",n.version=l(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return n.browser="Not a supported browser.",n;n.browser="safari",n.version=l(t.userAgent,/AppleWebKit\/(\d+)\./,1)}return n}function v(e){return"object"!=typeof e?e:Object.keys(e).reduce(function(t,n){const r="object"==typeof e[n],i=r?v(e[n]):e[n],o=r&&!Object.keys(i).length;return void 0===i||o?t:Object.assign(t,{[n]:i})},{})}const y=h;function b(e){const t=e&&e.navigator;if(!t.mediaDevices)return;const n=g(e),r=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach(n=>{if("require"===n||"advanced"===n||"mediaSource"===n)return;const r="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);const i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];let e={};"number"==typeof r.ideal?(e[i("min",n)]=r.ideal,t.optional.push(e),(e={})[i("max",n)]=r.ideal,t.optional.push(e)):(e[i("",n)]=r.ideal,t.optional.push(e))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",n)]=r.exact):["min","max"].forEach(e=>{void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])})}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},i=function(e,i){if(n.version>=61)return i(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){const t=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=r(e.audio)}if(e&&"object"==typeof e.video){let o=e.video.facingMode;o=o&&("object"==typeof o?o:{ideal:o});const a=n.version<66;if(o&&("user"===o.exact||"environment"===o.exact||"user"===o.ideal||"environment"===o.ideal)&&(!t.mediaDevices.getSupportedConstraints||!t.mediaDevices.getSupportedConstraints().facingMode||a)){let n;if(delete e.video.facingMode,"environment"===o.exact||"environment"===o.ideal?n=["back","rear"]:"user"!==o.exact&&"user"!==o.ideal||(n=["front"]),n)return t.mediaDevices.enumerateDevices().then(t=>{let a=(t=t.filter(e=>"videoinput"===e.kind)).find(e=>n.some(t=>e.label.toLowerCase().includes(t)));return!a&&t.length&&n.includes("back")&&(a=t[t.length-1]),a&&(e.video.deviceId=o.exact?{exact:a.deviceId}:{ideal:a.deviceId}),e.video=r(e.video),y("chrome: "+JSON.stringify(e)),i(e)})}e.video=r(e.video)}return y("chrome: "+JSON.stringify(e)),i(e)},o=function(e){return n.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};t.getUserMedia=function(e,n,r){i(e,e=>{t.webkitGetUserMedia(e,n,e=>{r&&r(o(e))})})}.bind(t);const a=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return i(e,e=>a(e).then(t=>{if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach(e=>{e.stop()}),new DOMException("","NotFoundError");return t},e=>Promise.reject(o(e))))}}function w(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then(t=>{const r=n.video&&n.video.width,i=n.video&&n.video.height,o=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},r&&(n.video.mandatory.maxWidth=r),i&&(n.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(n)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}function C(e,t,n){const r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;const o=[];return e.forEach(e=>{"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)}),o.forEach(t=>{e.forEach(n=>{n.type===r&&n.trackId===t.id&&function e(t,n,r){n&&!r.has(n.id)&&(r.set(n.id,n),Object.keys(n).forEach(i=>{i.endsWith("Id")?e(t,t.get(n[i]),r):i.endsWith("Ids")&&n[i].forEach(n=>{e(t,t.get(n),r)})}))}(e,n,i)})}),i}function S(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function T(e){if("object"!=typeof e||!e.RTCPeerConnection||"ontrack"in e.RTCPeerConnection.prototype)f(e,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e));else{Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=(t=>{t.stream.addEventListener("addtrack",n=>{let r;r=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(e=>e.track&&e.track.id===n.track.id):{track:n.track};const i=new Event("track");i.track=n.track,i.receiver=r,i.transceiver={receiver:r},i.streams=[t.stream],this.dispatchEvent(i)}),t.stream.getTracks().forEach(n=>{let r;r=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(e=>e.track&&e.track.id===n.id):{track:n};const i=new Event("track");i.track=n,i.receiver=r,i.transceiver={receiver:r},i.streams=[t.stream],this.dispatchEvent(i)})}),this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}}function E(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){let i=n.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};const r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach(e=>{this._senders.push(t(this,e))})};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],r.apply(this,[e]),e.getTracks().forEach(e=>{const t=this._senders.find(t=>t.track===e);t&&this._senders.splice(this._senders.indexOf(t),1)})}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function _(e){if(!("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then(t=>C(t,e.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e}),f(e,"track",e=>(e.receiver._pc=e.srcElement,e)),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then(t=>C(t,e.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,n,r;return this.getSenders().forEach(n=>{n.track===e&&(t?r=!0:t=n)}),this.getReceivers().forEach(t=>(t.track===e&&(n?r=!0:n=t),t.track===e)),r||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function k(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(e=>this._shimmedLocalStreams[e][0])};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const r=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(e=>{if(this.getSenders().find(t=>t.track===e))throw new DOMException("Track already exists.","InvalidAccessError")});const t=this.getSenders();n.apply(this,arguments);const r=this.getSenders().filter(e=>-1===t.indexOf(e));this._shimmedLocalStreams[e.id]=[e].concat(r)};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach(t=>{const n=this._shimmedLocalStreams[t].indexOf(e);-1!==n&&this._shimmedLocalStreams[t].splice(n,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]}),i.apply(this,arguments)}}function R(e){if(!e.RTCPeerConnection)return;const t=g(e);if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return k(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map(e=>this._reverseStreams[e.id])};const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach(e=>{if(this.getSenders().find(t=>t.track===e))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[t.id]){const n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}r.apply(this,[t])};const i=e.RTCPeerConnection.prototype.removeStream;function o(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(t=>{const r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(i.id,"g"),r.id)}),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const r=[].slice.call(arguments,1);if(1!==r.length||!r[0].getTracks().find(e=>e===t))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(e=>e.track===t))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const i=this._streams[n.id];if(i)i.addTrack(t),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const r=new e.MediaStream([t]);this._streams[n.id]=r,this._reverseStreams[r.id]=n,this.addStream(r)}return this.getSenders().find(e=>e.track===t)},["createOffer","createAnswer"].forEach(function(t){const n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){const e=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[t=>{const n=o(this,t);e[0].apply(null,[n])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):n.apply(this,arguments).then(e=>o(this,e))}});const a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(t=>{const r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(r.id,"g"),i.id)}),new RTCSessionDescription({type:t.type,sdp:n})}(this,arguments[0]),a.apply(this,arguments)):a.apply(this,arguments)};const s=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=s.get.apply(this);return""===e.type?e:o(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach(n=>{this._streams[n].getTracks().find(t=>e.track===t)&&(t=this._streams[n])}),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function P(e){if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,n,r){const i=arguments;if(arguments.length>0&&"function"==typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof arguments[0]))return t.apply(this,[]);const o=function(e){const t={};return e.result().forEach(e=>{const n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach(t=>{n[t]=e.stat(t)}),t[n.id]=n}),t},a=function(e){return new Map(Object.keys(e).map(t=>[t,e[t]]))};if(arguments.length>=2){const e=function(e){i[1](a(o(e)))};return t.apply(this,[e,arguments[0]])}return new Promise((e,n)=>{t.apply(this,[function(t){e(a(o(t)))},n])}).then(n,r)},["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}});const n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}function x(e){f(e,"negotiationneeded",e=>{if("stable"===e.target.signalingState)return e})}var A=n(6),M=n.n(A);function D(e){const t=e&&e.navigator,n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return n(e).catch(e=>Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString(){return this.name}}}(e)))}}function I(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator.mediaDevices)))}function j(e){const t=g(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){const t=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set(e){t.set.call(this,e);const n=new Event("enabled");n.enabled=e,this.dispatchEvent(n)}})}!e.RTCRtpSender||"dtmf"in e.RTCRtpSender.prototype||Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);const n=M()(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=function(e,t){let n=!1;return(e=JSON.parse(JSON.stringify(e))).filter(e=>{if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&m("RTCIceServer.url","RTCIceServer.urls");const r="string"==typeof t;return r&&(t=[t]),t=t.filter(e=>{if(0===e.indexOf("stun:"))return!1;const t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!n?(n=!0,!0):t&&!n}),delete e.url,e.urls=r?t[0]:t,!!t.length}})}(e.iceServers,t.version),h("ICE servers after filtering:",e.iceServers)),new n(e)},e.RTCPeerConnection.prototype=n.prototype}function O(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}function U(e){const t=g(e),n=e&&e.navigator,r=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,r){m("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,r)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},t=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(n){return"object"==typeof n&&"object"==typeof n.audio&&(n=JSON.parse(JSON.stringify(n)),e(n.audio,"autoGainControl","mozAutoGainControl"),e(n.audio,"noiseSuppression","mozNoiseSuppression")),t(n)},r&&r.prototype.getSettings){const t=r.prototype.getSettings;r.prototype.getSettings=function(){const n=t.apply(this,arguments);return e(n,"mozAutoGainControl","autoGainControl"),e(n,"mozNoiseSuppression","noiseSuppression"),n}}if(r&&r.prototype.applyConstraints){const t=r.prototype.applyConstraints;r.prototype.applyConstraints=function(n){return"audio"===this.kind&&"object"==typeof n&&(n=JSON.parse(JSON.stringify(n)),e(n,"autoGainControl","mozAutoGainControl"),e(n,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[n])}}}}function L(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})}function B(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function N(e){const t=g(e);if("object"!=typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}});const n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};const r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,n,o){return i.apply(this,[e||null]).then(e=>{if(t.version<53&&!n)try{e.forEach(e=>{e.type=r[e.type]||e.type})}catch(t){if("TypeError"!==t.name)throw t;e.forEach((t,n)=>{e.set(n,Object.assign({},t,{type:r[t.type]||t.type}))})}return e}).then(n,o)}}function $(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function G(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e}),f(e,"track",e=>(e.receiver._pc=e.srcElement,e)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function F(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){m("removeStream","removeTrack"),this.getSenders().forEach(t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)})})}function z(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function Y(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getTracks().forEach(n=>t.call(this,n,e))},e.RTCPeerConnection.prototype.addTrack=function(e,n){return n&&(this._localStreams?this._localStreams.includes(n)||this._localStreams.push(n):this._localStreams=[n]),t.call(this,e,n)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const n=e.getTracks();this.getSenders().forEach(e=>{n.includes(e.track)&&this.removeTrack(e)})})}}function J(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=(e=>{e.streams.forEach(e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)})}))}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach(t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const n=new Event("addstream");n.stream=t,e.dispatchEvent(n)})}),t.apply(e,arguments)}}}function K(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,i=t.setLocalDescription,o=t.setRemoteDescription,a=t.addIceCandidate;t.createOffer=function(e,t){const r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i};let s=function(e,t,n){const r=i.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r};t.setLocalDescription=s,s=function(e,t,n){const r=o.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.setRemoteDescription=s,s=function(e,t,n){const r=a.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.addIceCandidate=s}function V(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,n=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=(e=>n(q(e)))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t))}function q(e){return e&&void 0!==e.video?Object.assign({},e,{video:v(e.video)}):e}function W(e){const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){const t=[];for(let n=0;n<e.iceServers.length;n++){let r=e.iceServers[n];!r.hasOwnProperty("urls")&&r.hasOwnProperty("url")?(m("RTCIceServer.url","RTCIceServer.urls"),(r=JSON.parse(JSON.stringify(r))).urls=r.url,delete r.url,t.push(r)):t.push(e.iceServers[n])}e.iceServers=t}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function H(e){"object"==typeof e&&e.RTCPeerConnection&&"receiver"in e.RTCTrackEvent.prototype&&!e.RTCTransceiver&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Z(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find(e=>e.sender.track&&"audio"===e.sender.track.kind);!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const n=this.getTransceivers().find(e=>e.sender.track&&"video"===e.sender.track.kind);!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video")}return t.apply(this,arguments)}}var X=n(3),Q=n.n(X);function ee(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){const n=new t(e),r=Q.a.parseCandidate(e.candidate),i=Object.assign(n,r);return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,f(e,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t))}function te(e){if(e.RTCSctpTransport||!e.RTCPeerConnection)return;const t=g(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,function(e){const t=Q.a.splitSections(e.sdp);return t.shift(),t.some(e=>{const t=Q.a.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")})}(arguments[0])){const e=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const n=parseInt(t[1],10);return n!=n?-1:n}(arguments[0]),n=function(e){let n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n}(e),r=function(e,n){let r=65536;"firefox"===t.browser&&57===t.version&&(r=65535);const i=Q.a.matchPrefix(e.sdp,"a=max-message-size:");return i.length>0?r=parseInt(i[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(r=2147483637),r}(arguments[0],e);let i;i=0===n&&0===r?Number.POSITIVE_INFINITY:0===n||0===r?Math.max(n,r):Math.min(n,r);const o={};Object.defineProperty(o,"maxMessageSize",{get:()=>i}),this._sctp=o}return n.apply(this,arguments)}}function ne(e){if(!(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const n=e.send;e.send=function(){const r=arguments[0],i=r.length||r.size||r.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=n.apply(this,arguments);return t(e,this),e},f(e,"datachannel",e=>(t(e.channel,e.target),e))}function re(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(e=>{const n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=(e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e}),this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}})}function ie(e){if(!e.RTCPeerConnection)return;const t=g(e);if("chrome"===t.browser&&t.version>=71)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter(e=>"a=extmap-allow-mixed"!==e.trim()).join("\n")),n.apply(this,arguments)}}var oe=function({window:e}={},t={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0}){const n=h,c=g(e),u={browserDetails:c,commonShim:s,extractVersion:l,disableLog:p,disableWarnings:d};switch(c.browser){case"chrome":if(!r||!P||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),u;n("adapter.js shimming chrome."),u.browserShim=r,b(e),S(e),P(e),T(e),R(e),E(e),_(e),x(e),ee(e),re(e),te(e),ne(e),ie(e);break;case"firefox":if(!o||!N||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),u;n("adapter.js shimming firefox."),u.browserShim=o,U(e),N(e),B(e),F(e),$(e),G(e),z(e),ee(e),re(e),te(e),ne(e);break;case"edge":if(!i||!j||!t.shimEdge)return n("MS edge shim is not included in this adapter release."),u;n("adapter.js shimming edge."),u.browserShim=i,D(e),I(e),j(e),O(e),te(e),ne(e);break;case"safari":if(!a||!t.shimSafari)return n("Safari shim is not included in this adapter release."),u;n("adapter.js shimming safari."),u.browserShim=a,W(e),Z(e),K(e),Y(e),J(e),H(e),V(e),ee(e),te(e),ne(e),ie(e);break;default:n("Unsupported browser!")}return u}({window:window}),ae=n(0),se=n.n(ae),ce=n(1),ue=n.n(ce),le=n(2),fe=!1,pe={iceServers:[{urls:"stun:stun.l.google.com:19302"}]};function de(e,t,n){try{return we(ue.a.decodeBase64(e),t,n)}catch(e){return null}}function he(e,t){var n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}function me(e){var t=window.location.href,n=encodeURIComponent(be(e)),r=t.lastIndexOf("#");return-1==r?t+"#"+n:t.substring(0,r)+"#"+n}function ge(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];fe&&console.log.apply(console,[e].concat(t))}function ve(){var e=se.a.box.keyPair();return{publicKey:e.publicKey,privateKey:e.secretKey}}function ye(e,t,n){var r=Te(t)+"-"+be(e);return n&&(r+="-"+n),se.a.hash(ue.a.decodeUTF8(r)).slice(0,se.a.secretbox.keyLength)}function be(e){return e.replace(/ /g,"-")}function we(e,t,n){if(e.length<se.a.box.nonceLength+1)return null;var r=e.slice(-se.a.box.nonceLength),i=e.slice(0,-se.a.box.nonceLength),o=se.a.box.open(i,r,n,t);if(null==o)return null;var a=JSON.parse(ue.a.encodeUTF8(o));return null==a||null==a.sdp||null==a.type?null:a}function Ce(e,t,n){var r=ue.a.decodeUTF8(JSON.stringify(e)),i=se.a.randomBytes(se.a.box.nonceLength);return he(se.a.box(r,i,n,t),i)}function Se(e,t){var n=ue.a.encodeBase64(se.a.hash(ue.a.decodeUTF8(be(e)+"-"+Te(t))));return(n=n.replace(/=/g,"").replace(/\+/g,"_").replace(/\//g,"-")).substring(0,20)}function Te(e){var t=e.getUTCDate()+"-";2==t.length&&(t="0"+t);var n=e.getUTCMonth()+1;return(t+=n<10?"0"+n:n)+"-"+e.getUTCFullYear()}var Ee=n(4),_e=n.n(Ee),ke=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}c((r=r.apply(e,t||[])).next())})},Re=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function Pe(e){return function(e){return ke(this,void 0,void 0,function(){return Re(this,function(t){return[2,new Ae(_e()(xe),e)]})})}(e)}fe||(_e.a.log.off=!0);var xe="https://gunjs.herokuapp.com/gun";var Ae=function(){function e(e,t){this.room=e.get("myscreen.live-"+t)}return e.prototype.pub=function(e){return ke(this,void 0,void 0,function(){return Re(this,function(t){return ge("Sending message",e),this.room.put({msg:e}),[2]})})},e.prototype.setSub=function(e){return ke(this,void 0,void 0,function(){return Re(this,function(t){return this.room.on(function(t){ge("Received message",t),t.msg&&e(t.msg)}),[2]})})},e.prototype.close=function(){return ke(this,void 0,void 0,function(){return Re(this,function(e){return this.room.off(),[2]})})},e}();!function(){function e(e){this.ws=new WebSocket(e)}e.prototype.pub=function(e){return ke(this,void 0,void 0,function(){return Re(this,function(t){return ge("Sending message",e),this.ws.send(e),[2]})})},e.prototype.setSub=function(e){return ke(this,void 0,void 0,function(){return Re(this,function(t){return this.ws.onmessage=function(t){ge("Received message",t),e(t.data)},[2]})})},e.prototype.close=function(){return ke(this,void 0,void 0,function(){return Re(this,function(e){return this.ws.close(),[2]})})}}();var Me=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}c((r=r.apply(e,t||[])).next())})},De=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Ie=function(){function e(){var e=this;this.elem=document.getElementById("client"),this.settingsButtonElem=document.getElementById("clientSettingsButton"),this.settingsElem=document.getElementById("clientSettings"),this.phraseElem=document.getElementById("clientPhrase"),this.passwordElem=document.getElementById("clientPassword"),this.errElem=document.getElementById("clientErr"),this.connectingElem=document.getElementById("clientConnecting"),this.videoElem=document.getElementById("clientVideo"),this.settingsButtonElem.onclick=function(){"none"==e.settingsElem.style.display?(e.settingsButtonElem.innerHTML="Settings &#9650;",e.settingsElem.style.display="flex"):(e.settingsButtonElem.innerHTML="Settings &#9660;",e.settingsElem.style.display="none")},document.getElementById("clientConnect").onclick=function(){e.stop(),e.connect()},this.videoElem.onloadedmetadata=function(){var t=e.videoElem.videoWidth,n=e.videoElem.videoHeight;ge("Metadata loaded, width and height:",t,n),e.videoElem.style.width=t+"px",e.videoElem.style.height=n+"px"}}return e.prototype.displayErr=function(e){e?(this.errElem.innerText=""+e,this.errElem.style.display="block"):(this.errElem.innerText="",this.errElem.style.display="none")},e.prototype.show=function(){var e;this.elem.style.display="flex",this.phraseElem.value=((e=window.location.hash).startsWith("#")&&(e=e.substring(1)),decodeURIComponent(e).replace(/-/g," "))},e.prototype.reset=function(){this.elem.style.display="none",this.settingsButtonElem.innerHTML="Settings &#9650;",this.settingsElem.style.display="flex",this.phraseElem.value="",this.passwordElem.value="",this.stop()},e.prototype.stop=function(){this.displayErr(null),this.connectingElem.style.display="none",this.videoElem.style.display="none",this.videoElem.style.width="",this.videoElem.style.height="",this.videoElem.pause(),this.videoElem.removeAttribute("src"),this.videoElem.load(),null!=this.peerConn&&(this.peerConn.close(),this.peerConn=void 0)},e.prototype.connect=function(){return Me(this,void 0,void 0,function(){var e,t;return De(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),this.settingsButtonElem.innerHTML="Settings &#9660;",this.settingsElem.style.display="none",this.connectingElem.style.display="flex",[4,this.connectToHost()];case 1:return e=n.sent(),this.peerConn=e.peerConn,this.connectingElem.style.display="none",this.videoElem.style.display="flex",ge("Got peer conn and track",e),this.videoElem.srcObject=e.track,[4,this.videoElem.play()];case 2:return n.sent(),[3,4];case 3:return t=n.sent(),console.error(t),this.stop(),this.displayErr(t),[3,4];case 4:return[2]}})})},e.prototype.connectToHost=function(){return Me(this,void 0,void 0,function(){var e,t,n,r,i,o,a,s,c,u,l,f=this;return De(this,function(p){switch(p.label){case 0:return e=this.phraseElem.value,t=this.passwordElem.value,n=new Date,[4,Pe(Se(e,n))];case 1:r=p.sent(),i=null,p.label=2;case 2:return p.trys.push([2,6,,7]),o=ve(),a=function(e,t,n,r){var i=ue.a.decodeUTF8(JSON.stringify({offerRequest:ue.a.encodeBase64(n)})),o=se.a.randomBytes(se.a.secretbox.nonceLength),a=se.a.secretbox(i,o,ye(e,t,r));return ue.a.encodeBase64(he(a,o))}(e,n,o.publicKey,t),s=new Promise(function(e,t){return Me(f,void 0,void 0,function(){return De(this,function(n){switch(n.label){case 0:return setTimeout(function(){return t(new Error("Timeout waiting for offer response"))},6e4),[4,r.setSub(function(t){var n=function(e,t){try{var n=ue.a.decodeBase64(e);if(n.length<se.a.box.publicKeyLength+1)return null;var r=n.slice(-se.a.box.publicKeyLength),i=we(n.slice(0,-se.a.box.publicKeyLength),t,r);return null==i?null:{offer:i,hostPublicKey:r}}catch(e){return null}}(t,o.privateKey);null!=n&&(ge("Message was valid offer",n),e(n))})];case 1:return n.sent(),[2]}})})}),ge("Sending offer request",a),[4,r.pub(a)];case 3:return p.sent(),[4,s];case 4:return c=p.sent(),u=new RTCPeerConnection(pe),i=u,[4,new Promise(function(e,t){return Me(f,void 0,void 0,function(){var n,i=this;return De(this,function(a){switch(a.label){case 0:return setTimeout(function(){return t(new Error("Timeout waiting for to build answer"))},6e4),u.oniceconnectionstatechange=function(){return ge("RTC browser state change: "+u.iceConnectionState)},u.onicecandidate=function(e){return Me(i,void 0,void 0,function(){return De(this,function(t){switch(t.label){case 0:if(null!==e.candidate)return[3,2];if(null==u.localDescription)throw new Error("Missing local desc");return ge("Sending answer",u.localDescription),[4,r.pub((n=u.localDescription,i=o.privateKey,a=c.hostPublicKey,ue.a.encodeBase64(Ce(n,i,a))))];case 1:t.sent(),t.label=2;case 2:return[2]}var n,i,a})})},u.ontrack=function(t){return e({peerConn:u,track:t.streams[0]})},[4,u.setRemoteDescription(c.offer)];case 1:return a.sent(),[4,u.createAnswer()];case 2:return n=a.sent(),[4,u.setLocalDescription(n)];case 3:return a.sent(),[2]}})})})];case 5:return[2,p.sent()];case 6:throw l=p.sent(),r.close(),null!=i&&i.close(),l;case 7:return[2]}})})},e}(),je=function(){function e(){this.elem=document.getElementById("home");var e=document.getElementById("homePhrase"),t=document.getElementById("homeConnect");e.onkeypress=function(t){13==t.keyCode&&e.value.length>=3&&(window.location.href=me(e.value))},e.onchange=function(){return t.href=me(e.value)},e.oninput=function(){return t.href=me(e.value)}}return e.prototype.show=function(){this.elem.style.display="flex"},e.prototype.reset=function(){this.elem.style.display="none"},e}(),Oe=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}c((r=r.apply(e,t||[])).next())})},Ue=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Le=function(){function e(){var e=this;this.peerConns=[],this.elem=document.getElementById("host"),this.errElem=document.getElementById("hostErr"),this.settingsElem=document.getElementById("hostSettings"),this.phraseElem=document.getElementById("hostPhrase"),this.passwordElem=document.getElementById("hostPassword"),this.workingElem=document.getElementById("hostWorking"),this.sharingElem=document.getElementById("hostSharing"),this.shareUrlElem=document.getElementById("hostShareUrl"),this.shareClientCountElem=document.getElementById("hostShareClientCount"),this.sharePauseElem=document.getElementById("hostSharePause"),this.shareVideoElem=document.getElementById("hostShareVideo"),document.getElementById("hostRegenerate").onclick=function(){return e.regeneratePhrase()},this.phraseElem.onchange=function(){return document.getElementById("hostPotentialUrl").innerText=me(e.phraseElem.value)},this.phraseElem.oninput=function(){return document.getElementById("hostPotentialUrl").innerText=me(e.phraseElem.value)},document.getElementById("hostChooseScreen").onclick=function(){return Oe(e,void 0,void 0,function(){var e;return Ue(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.startShare()];case 1:return t.sent(),[3,3];case 2:return e=t.sent(),console.error(e),this.stop(),this.displayErr(e),[3,3];case 3:return[2]}})})},this.sharePauseElem.onclick=function(){if(null!=e.stream){var t="Pause Video"!=e.sharePauseElem.innerText;e.stream.getTracks().forEach(function(e){return e.enabled=t}),e.sharePauseElem.innerText=t?"Pause Video":"Resume Video"}},document.getElementById("hostShareStop").onclick=function(){return e.stop()}}return e.prototype.displayErr=function(e){e?(this.errElem.innerText=""+e,this.errElem.style.display="block"):(this.errElem.innerText="",this.errElem.style.display="none")},e.prototype.show=function(){this.elem.style.display="flex",this.regeneratePhrase()},e.prototype.reset=function(){this.elem.style.display="none",this.phraseElem.value="",this.passwordElem.value="",this.stop()},e.prototype.stop=function(){this.displayErr(null),this.workingElem.style.display="none",this.sharingElem.style.display="none",this.settingsElem.style.display="flex",this.sharePauseElem.innerText="Pause Video",this.peerConns.forEach(function(e){return e.close()}),this.peerConns=[],null!=this.hostSignalers&&(this.hostSignalers.forEach(function(e){return e.close()}),this.hostSignalers=void 0),null!=this.stream&&(this.stream.getTracks().forEach(function(e){return e.stop()}),this.stream=void 0),this.shareVideoElem.pause(),this.shareVideoElem.removeAttribute("src"),this.shareVideoElem.load()},e.prototype.regeneratePhrase=function(){var e;this.phraseElem.value=(e=new Uint16Array(5),crypto.getRandomValues(e),e[0]%31+2+" "+le.adjectives[e[1]%le.adjectives.length]+" "+le.nouns[e[2]%le.nouns.length]+" "+le.verbs[e[3]%le.verbs.length]+" "+le.adverbs[e[4]%le.adverbs.length]),this.phraseElem.dispatchEvent(new Event("change",{bubbles:!0}))},e.prototype.startShare=function(){return Oe(this,void 0,void 0,function(){var e,t,n,r=this;return Ue(this,function(i){switch(i.label){case 0:return this.shareUrlElem.innerText=me(this.phraseElem.value),this.shareUrlElem.href=this.shareUrlElem.innerText,this.shareClientCountElem.innerText="0",this.settingsElem.style.display="none",this.sharingElem.style.display="none",this.workingElem.style.display="flex",this.phraseElem.reportValidity()?(e=this,[4,navigator.mediaDevices.getDisplayMedia({video:{cursor:"always"},audio:!1})]):[2];case 1:return e.stream=i.sent(),this.shareVideoElem.srcObject=this.stream,[4,this.shareVideoElem.play()];case 2:return i.sent(),this.workingElem.style.display="none",this.sharingElem.style.display="flex",t=this,[4,Be.create(this.stream,this.phraseElem.value,new Date,-1,this.passwordElem.value,function(e){return r.onNewClient(e)})];case 3:return n=[i.sent()],[4,Be.create(this.stream,this.phraseElem.value,new Date,0,this.passwordElem.value,function(e){return r.onNewClient(e)})];case 4:return n=n.concat([i.sent()]),[4,Be.create(this.stream,this.phraseElem.value,new Date,1,this.passwordElem.value,function(e){return r.onNewClient(e)})];case 5:return t.hostSignalers=n.concat([i.sent()]),[2]}})})},e.prototype.onNewClient=function(e){var t=this;this.peerConns.push(e),this.shareClientCountElem.innerText=""+this.peerConns.length,e.oniceconnectionstatechange=function(){if(ge("RTC browser state change: "+e.iceConnectionState),"closed"==e.iceConnectionState||"disconnected"==e.iceConnectionState){var n=t.peerConns.indexOf(e);n>=0&&(t.peerConns.splice(n,1),t.shareClientCountElem.innerText=""+t.peerConns.length)}}},e}(),Be=function(){function e(e,t,n,r,i,o){var a=this;this.pendingAnswers=[],this.stream=e,this.phrase=t,this.date=n,this.password=r,this.onNewClient=i,this.pubSub=o,this.pubSub.setSub(function(e){var t=function(e,t,n,r){try{var i=ue.a.decodeBase64(e);if(i.length<se.a.secretbox.nonceLength+1)return null;var o=i.slice(-se.a.secretbox.nonceLength),a=i.slice(0,-se.a.secretbox.nonceLength),s=se.a.secretbox.open(a,o,ye(t,n,r));if(null==s)return null;var c=JSON.parse(ue.a.encodeUTF8(s));return null==c||null==c.offerRequest?null:ue.a.decodeBase64(c.offerRequest)}catch(e){return null}}(e,a.phrase,a.date,a.password);if(null!=t)ge("Message was valid offer request",t),a.onOfferRequest(t);else{for(var n=0,r=a.pendingAnswers;n<r.length;n++){var i=r[n],o=de(e,i.myKey.privateKey,i.theirPub);if(null!=o)return ge("Message was valid answer",o),void a.onAnswerReceived(i,o)}ge("Message was unrecognized")}})}return e.create=function(t,n,r,i,o,a){return Oe(this,void 0,void 0,function(){var s,c;return Ue(this,function(u){switch(u.label){case 0:return r.setUTCFullYear(r.getUTCFullYear()+i),ge("Starting signaler on room "+(s=Se(n,r))),[4,Pe(s)];case 1:return c=u.sent(),[2,new e(t,n,r,o,a,c)]}})})},e.prototype.onOfferRequest=function(e){var t=this,n=new RTCPeerConnection(pe),r=ve(),i={myKey:r,theirPub:e,peerConn:n},o=function(){var e=t.pendingAnswers.indexOf(i);e>=0&&(n.close(),t.pendingAnswers.splice(e,1))};n.oniceconnectionstatechange=function(){return ge("RTC browser state change: "+n.iceConnectionState)},n.onicecandidate=function(a){if(null===a.candidate){if(null==n.localDescription)throw new Error("Missing local desc");t.pendingAnswers.push(i),setTimeout(function(){return o()},6e4),t.pubSub.pub(function(e,t,n){var r=Ce(e,t.privateKey,n);return ue.a.encodeBase64(he(r,t.publicKey))}(n.localDescription,r,e))}},n.onnegotiationneeded=function(e){return n.createOffer().then(function(e){return n.setLocalDescription(e)}).catch(function(e){o(),console.error(e)})},this.stream.getTracks().forEach(function(e){return n.addTrack(e,t.stream)})},e.prototype.onAnswerReceived=function(e,t){return Oe(this,void 0,void 0,function(){var n,r;return Ue(this,function(i){switch(i.label){case 0:(n=this.pendingAnswers.indexOf(e))>=0&&this.pendingAnswers.splice(n,1),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,e.peerConn.setRemoteDescription(t)];case 2:return i.sent(),null!=this.onNewClient&&this.onNewClient(e.peerConn),[3,4];case 3:return r=i.sent(),e.peerConn.close(),console.error(r),[3,4];case 4:return[2]}})})},e.prototype.close=function(){this.pendingAnswers.forEach(function(e){return e.peerConn.close()}),this.pendingAnswers=[],this.pubSub.close()},e}();!function(){var e=new Ie,t=new je,n=new Le;function r(r){r?"firefox"==oe.browserDetails.browser&&oe.browserShim.shimGetDisplayMedia(window,"screen"):(e.reset(),t.reset(),n.reset()),window.location.hash?"#host"==window.location.hash?n.show():e.show():t.show()}window.onpopstate=function(){return r(!1)},r(!0)}()}]);